<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA23204185" />

<meta name="date" content="2023-12-10" />

<title>Homework of all time</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of all time</h1>
<h4 class="author">SA23204185</h4>
<h4 class="date">2023-12-10</h4>



<div id="homework-1" class="section level2">
<h2>Homework 1</h2>
<hr />
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p>We will realize the IPW algorithm in Cho(2017).</p>
<p>Don’t worry too much about this piece of code. In fact, I’ve been
working on replicating an article during this period. Treat it as <a href>inputting a matrix <span class="math inline">\(M\)</span></a>,
and it will <a href>give you back a <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span></a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>IPW <span class="ot">&lt;-</span> <span class="cf">function</span>(M, <span class="at">K=</span><span class="dv">2</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(M)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">ncol</span>(M)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(M <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># 使用向量化操作代替循环</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y) <span class="sc">/</span> (n <span class="sc">*</span> d)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  Sigma_phat <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(M) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat) <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">colSums</span>(M<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  Sigma_tphat <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(<span class="fu">t</span>(M)) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat) <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rowSums</span>(M<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  eigen_Sigma_phat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_phat)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  eigen_Sigma_tphat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_tphat)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="co"># 得到分解</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  V <span class="ot">&lt;-</span> eigen_Sigma_phat<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span>K]</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(eigen_Sigma_phat<span class="sc">$</span>values[<span class="dv">1</span><span class="sc">:</span>K] <span class="sc">-</span> <span class="fu">sum</span>(eigen_Sigma_phat<span class="sc">$</span>values[(K<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>d]) <span class="sc">/</span> (d <span class="sc">-</span> K <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> p_hat</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  U <span class="ot">&lt;-</span> eigen_Sigma_tphat<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span>K]</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">V =</span> V, <span class="at">U =</span> U, <span class="at">lambda_hat =</span> lambda_hat))</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>}</span></code></pre></div>
<p>We will give out a <span class="math inline">\(M\)</span> to try
it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>initial<span class="ot">&lt;-</span><span class="cf">function</span>(n,d){</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> <span class="dv">2</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>), n, <span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(d <span class="sc">*</span> <span class="dv">2</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>), d, <span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  M0 <span class="ot">&lt;-</span> A<span class="sc">%*%</span><span class="fu">t</span>(B)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">return</span>(M0)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<ul>
<li>The result of <span class="math inline">\(V\)</span> is as follow,
and we will use table to show the result:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#xtable::xtable(IPW(initial(n = 10, d = 2))$V)</span></span></code></pre></div>
<hr />
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<ul>
<li>So the result <span class="math inline">\(U\)</span> after use IPW
in M is as follow, and we will use photo to show the result:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">IPW</span>(<span class="fu">initial</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">d =</span> <span class="dv">2</span>))<span class="sc">$</span>U</span></code></pre></div>
<ul>
<li>Source U for Example 2</li>
</ul>
<hr />
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<ul>
<li>We will write down the Thereom 1 in Cho(2017), so we have
mathematical formulas.</li>
</ul>
<p><span class="math display">\[\begin{align*}
&amp; \mathbb{E}\left\|\sin \left(\hat{V}^{(m)},
V^{(m)}\right)\right\|_{F}^{2} \leq \frac{C_{1}
n^{-1}}{p\left(b_{m}^{2}-b_{m+1}^{2}\right)^{2}} \\
\end{align*}\]</span></p>
<hr />
</div>
</div>
<div id="homework-2" class="section level2">
<h2>Homework 2</h2>
<hr />
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Reproduce part of the functionality of the sample function using the
inverse transform method, with replace=TRUE.</li>
</ul>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<ul>
<li>Considering the code provided in the PDF, we have:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>my_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(values, n, <span class="at">probabilities =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(values), <span class="fu">length</span>(values))) {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="co"># Compute the cumulative distribution function</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(probabilities)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="co"># Generate random numbers</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> values[<span class="fu">findInterval</span>(u, cdf)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  }</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Here is a practical example to demonstrate that we have replicated
part of the functionality of the sample function.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Initialize the values to be sampled and the sample size</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>random_samples <span class="ot">&lt;-</span> <span class="fu">my_sample</span>(values, n)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">print</span>(random_samples)</span></code></pre></div>
<pre><code>##  [1] 5 7 4 2 4 5 5 4 2 9</code></pre>
<hr />
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Exercises 3.2 (Statistical Computing with R)</li>
</ul>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Generate random samples from the standard Laplace distribution using the inverse transform method</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>inverse_sample_laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(u <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> u), <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> u))</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>}</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># Generate 1000 random samples from the standard Laplace distribution</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>laplace_samples <span class="ot">&lt;-</span> <span class="fu">inverse_sample_laplace</span>(n)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># Plot the histogram of the generated samples</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">hist</span>(laplace_samples, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Samples vs Laplace Distribution&quot;</span>,</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co"># Plot the density function curve of the standard Laplace distribution</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>density_laplace <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">lines</span>(x, density_laplace, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Generated Samples&quot;</span>, <span class="st">&quot;Laplace Distribution&quot;</span>),</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>From the above plot, we can observe that we have successfully
generated samples that follow the Laplace distribution using the inverse
transform method.</li>
</ul>
<hr />
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Exercises 3.7 (Statistical Computing with R)</li>
</ul>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Rejection sampling to generate random samples from the beta distribution</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>generate_beta_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="co"># Let g(x) = 1, 0 &lt; x &lt; 1 and M = max(a, b) + 1. </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">max</span>(a, b) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="cf">while</span> (count <span class="sc">&lt;</span> n) {</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    </span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dbeta</span>(x, a, b) <span class="sc">&gt;</span> M<span class="sc">*</span>u) {</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>      samples[count <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> x</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>      count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>    }</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>  }</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>  </span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Generate random samples from the Beta(3, 2) distribution</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>beta_samples <span class="ot">&lt;-</span> <span class="fu">generate_beta_sample</span>(n, a, b)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Plot the histogram of the generated samples</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">hist</span>(beta_samples, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Samples vs. Beta(3,2) Distribution&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># Plot the density function curve of the Beta(3, 2) distribution</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>density_beta <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, a, b)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">lines</span>(x, density_beta, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Generated Samples&quot;</span>, <span class="st">&quot;Beta(3,2) Distribution&quot;</span>),</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>From the plot above, we can observe that we have successfully
generated samples that follow the Beta(3, 2) distribution using the
rejection sampling method.</li>
</ul>
<hr />
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<ul>
<li>Exercises 3.9 (Statistical Computing with R)</li>
</ul>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Generate samples using the method described in the question</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>generate_epanechnikov_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    U1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    U2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    U3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(U3) <span class="sc">&gt;=</span> <span class="fu">abs</span>(U2) <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(U3) <span class="sc">&gt;=</span> <span class="fu">abs</span>(U1)) {</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> U2</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> U3</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    }</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  }</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  </span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Generate a large number of simulated random samples</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>epanechnikov_samples <span class="ot">&lt;-</span> <span class="fu">generate_epanechnikov_sample</span>(n)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Construct a histogram density estimate</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">hist</span>(epanechnikov_samples, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram Density Estimate&quot;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># Construct a histogram density estimate</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>density_epanechnikov <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="fu">lines</span>(x, density_epanechnikov, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Kernel&quot;</span>),</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>From the plot above, we can observe that we have successfully
generated samples that follow the Epanechnikov kernel density function
using the method described in the question.</li>
</ul>
<hr />
</div>
<div id="question-5" class="section level3">
<h3>Question 5</h3>
<ul>
<li>Exercises 3.10 (Statistical Computing with R)</li>
</ul>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<ul>
<li><h2 id="solution-for-3.10">Solution for 3.10</h2></li>
</ul>
</div>
</div>
<div id="homework-3" class="section level2">
<h2>Homework 3</h2>
<hr />
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<ul>
<li>关于 Buffon’s Needle Experiment：
<ul>
<li>找一个最优的<span class="math inline">\(\frac{l}{d}\)</span>，使得<span class="math inline">\(\hat{\pi} = \frac{2l}{d\hat{p}}\)</span>，<span class="math inline">\(\hat{p}=\frac{n}{m}\)</span> 的渐近方差最小(<span class="math inline">\(\Delta\)</span>方法，<span class="math inline">\(n\)</span>~<span class="math inline">\(B(m,p)\)</span>)，记最优的<span class="math inline">\(\rho\)</span>为<span class="math inline">\(\rho_{min}\)</span>。</li>
<li>取三个不同的<span class="math inline">\(\rho\)</span>(<span class="math inline">\(0 \le \rho \le 1\)</span>，其中一个为<span class="math inline">\(\rho_{min}\)</span>)
<ul>
<li>如<span class="math inline">\(\rho_{min} = 1\)</span>，
取另外两个<span class="math inline">\(\rho\)</span>为0.5和0.8。</li>
<li>如<span class="math inline">\(\rho_{min} &lt;
1\)</span>，取另外两个<span class="math inline">\(\rho\)</span>为<span class="math inline">\(\frac{\rho_{min}}{2}\)</span>和1。
用MC方法比较三个<span class="math inline">\(rho\)</span>之下的<span class="math inline">\(\hat{\pi}\)</span>的方差（取<span class="math inline">\(m = 10^6\)</span>, <span class="math inline">\(Monte = 100\)</span>)</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<ul>
<li>我们首先回答第一个问题，以下运用<span class="math inline">\(\Delta\)</span>方法： 令<span class="math inline">\(\hat{\pi} = f_{\pi}(\hat{p})\)</span>， 其中<span class="math inline">\(f_{\pi}(x) := \frac{2\rho}{x}\)</span></li>
</ul>
<p>现在，我们知道<span class="math inline">\(m\hat{p}\)</span> ~ <span class="math inline">\(B(m,p)\)</span> ，显然有<span class="math inline">\(E(\hat{p}) = p\)</span>，<span class="math inline">\(Var(\hat{p}) = \frac{p(1-p)}{m}\)</span></p>
<p>所以根据<span class="math inline">\(\Delta\)</span>方法，我们有</p>
<p><span class="math display">\[
  Var(\hat{\pi}) \approx  f_{\pi}^{&#39;2}(p) Var(\hat{p})
\]</span></p>
<p>所以<span class="math inline">\(Var(\hat{\pi}) \approx
4\frac{1-p}{mp^3}\rho^2\)</span>，且<span class="math inline">\(p =
\frac{2\pi}{\rho}\)</span>，代入我们有：</p>
<p><span class="math display">\[
  Var(\hat{\pi}) \approx \frac{\pi^{3}}{2m}(\frac{1}{\rho} -
\frac{2}{\pi})
\]</span></p>
<p>又<span class="math inline">\(\rho \in (0,1]，\)</span>所以当<span class="math inline">\(\rho = 1\)</span>，<span class="math inline">\(\hat{\pi}\)</span>方差最小。</p>
<ul>
<li>我们现在回答第二个问题，用MC方法比较</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># 构造pi_hat的输出函数</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>var_pi <span class="ot">&lt;-</span> <span class="cf">function</span>(rho, <span class="at">seed =</span> <span class="dv">1</span>) {</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="co"># 直接假定d = 1 ，则此时l = rho </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="dv">0</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="dv">0</span>, pi <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  pihat <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> rho <span class="sc">/</span> <span class="fu">mean</span>(rho <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(Y) <span class="sc">&gt;</span> X)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># 构造函数，使得得到多个pi_hat以计算方差</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>var_pi_monte <span class="ot">&lt;-</span> <span class="cf">function</span>(rho, monte) {</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  var_pi_result <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>monte, <span class="cf">function</span>(i) <span class="fu">var_pi</span>(rho, i))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(<span class="fu">var</span>(var_pi_result),<span class="dv">6</span>))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>rho_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(rho_values, var_pi_monte, <span class="at">monte =</span> <span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">&quot;当分别代入&quot;</span>, <span class="fu">paste</span>(rho_values, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>), <span class="st">&quot;时，我们有方差分别为:&quot;</span>, <span class="fu">paste</span>(results, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)))</span></code></pre></div>
<pre><code>## 当分别代入 0.5, 0.8, 1 时，我们有方差分别为: 1.8e-05, 8e-06, 4e-06</code></pre>
<p>显然，随着<span class="math inline">\(\rho\)</span>的增加，方差在减小。且<span class="math inline">\(\rho =
1\)</span>时方差最小，符合我们的理论计算。</p>
<hr />
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 5.6</li>
</ul>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<ul>
<li>Answer for 5.6</li>
</ul>
<hr />
</div>
<div id="question-3-1" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 5.7</li>
</ul>
</div>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># 创建估计函数，输出theta_hat的估计，theta_hat的antithetic估计，和真实的theta</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(x))  <span class="co"># Simple Monte Carlo method</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m <span class="sc">/</span> <span class="dv">2</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  theta_hat_antithetic <span class="ot">&lt;-</span> (<span class="fu">mean</span>(<span class="fu">exp</span>(x1))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x1)))<span class="sc">/</span><span class="dv">2</span>  <span class="co"># Antithetic variate approach</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="fu">c</span>(theta_hat, theta_hat_antithetic, true)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>}</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co"># 重复以便计算出方差</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">estimate</span>())</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>var_simple <span class="ot">&lt;-</span> <span class="fu">var</span>(result[<span class="dv">1</span>, ])</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(result[<span class="dv">2</span>, ])</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>percent_reduction_var <span class="ot">&lt;-</span> (var_simple <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_simple</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co"># 输出方差及其减少百分比</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot; Simple Monte Carlo method:&quot;</span>, var_simple, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>                <span class="st">&quot;Antithetic variate approach:&quot;</span>, var_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>                <span class="st">&quot;Empirical estimate of the percent reduction:&quot;</span>, percent_reduction_var, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>                <span class="st">&quot;True percent reduction:&quot;</span>, (<span class="fu">exp</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="dv">8</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="dv">6</span>))</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="fu">cat</span>(output)</span></code></pre></div>
<pre><code>##  Simple Monte Carlo method: 0.000232501873781929 
##  Antithetic variate approach: 7.84235673537265e-06 
##  Empirical estimate of the percent reduction: 0.966269705238039 
##  True percent reduction: 0.983835035717261</code></pre>
<p>可见模拟的减少比例和真实比例非常接近。</p>
<hr />
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.14</span>, <span class="fl">2.10</span>, <span class="fl">2.13</span>, <span class="fl">2.15</span>, <span class="fl">2.13</span>, <span class="fl">2.12</span>, <span class="fl">2.13</span>, <span class="fl">2.10</span>, </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>          <span class="fl">2.15</span>, <span class="fl">2.12</span>, <span class="fl">2.14</span>, <span class="fl">2.10</span>, <span class="fl">2.13</span>, <span class="fl">2.11</span>, <span class="fl">2.14</span>, <span class="fl">2.11</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">var</span>(data)</span></code></pre></div>
<pre><code>## [1] 0.0002933333</code></pre>
<hr />
</div>
</div>
<div id="homework-4" class="section level2">
<h2>Homework 4</h2>
<hr />
<div id="question-1-2" class="section level3">
<h3>Question 1</h3>
<ul>
<li><p><span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^{M}\right)=\operatorname{Var}\left(\hat{\theta}^{S}\right)+\operatorname{Var}\left(\theta_{I}\right),
\text { where } \theta_{i}=E[g(U) \mid I=i],
\sigma_{i}^{2}=\operatorname{Var}[g(U) \mid I=i]\)</span>, and I takes
uniform distribution over <span class="math inline">\(\{1, \ldots,
k\}\)</span> .</p></li>
<li><p>Proof that if g is a continuous function over (a, b) , then <span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^{S}\right) /
\operatorname{Var}\left(\hat{\theta}^{M}\right) \rightarrow 0\)</span>
as <span class="math inline">\(b_{i}-a_{i} \rightarrow 0\)</span> for
all <span class="math inline">\(i=1, \ldots, k.\)</span></p></li>
</ul>
</div>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<ul>
<li>事实上，我们知道题目等价于只需证明:</li>
</ul>
<p><span class="math display">\[
  lim_{k \to  \infty}
\frac{M\operatorname{Var}\left(\hat{\theta}^{S}\right)}{\operatorname{Var}\left(\theta_{I}\right)}=
\frac{E[Var(g(U |J)]}{Var(E[g(U |J)]} \to  0
\]</span></p>
<p>当<span class="math inline">\(k \to \infty\)</span>，这显然成立。</p>
<hr />
</div>
<div id="question-2-2" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 5.13</li>
</ul>
</div>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">library</span>(bayesmeta)  <span class="co"># 引入 bayesmeta 包，用于生成瑞利分布</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># 定义函数 g(x)</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>}</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)  <span class="co"># 生成从 0 到 10，步长为 0.1 的序列作为 x 值</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co"># 计算函数 g(x) 在 xs 上的取值</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>ys.g <span class="ot">&lt;-</span> <span class="fu">g</span>(xs)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co"># 生成瑞利分布在 xs 上的取值，其中 scale 参数为 1.5</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>ys.rayleigh <span class="ot">&lt;-</span> <span class="fu">drayleigh</span>(xs, <span class="at">scale =</span> <span class="fl">1.5</span>)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co"># 生成正态分布在 xs 上的取值，其中 mean 参数为 1.5</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>ys.norm <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xs, <span class="at">mean =</span> <span class="fl">1.5</span>)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>lim <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(ys.g, ys.rayleigh, ys.norm))  <span class="co"># 计算三个函数的取值的最大值</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co"># 绘制函数曲线</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="fu">plot</span>(xs, ys.g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))  <span class="co"># 绘制函数 g(x) 的曲线，y 轴范围为 0 到 lim</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="fu">lines</span>(xs, ys.rayleigh, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))  <span class="co"># 绘制瑞利分布的曲线，颜色为红色，y 轴范围为 0 到 lim</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="fu">lines</span>(xs, ys.norm, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))  <span class="co"># 绘制正态分布的曲线，颜色为蓝色，y 轴范围为 0 到 lim</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><span class="math inline">\(f_{1}(x) = drayleigh(x, scale =
1.5)\)</span>，<span class="math inline">\(f_{2}(x) = dnorm(x, mean =
1.5)\)</span>。而<span class="math inline">\(f_{2}\)</span> 距离<span class="math inline">\(g\)</span>更近，效果应该更好。</li>
</ul>
<hr />
</div>
<div id="question-3-2" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 5.14</li>
</ul>
</div>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e4</span>  <span class="co"># 总样本量</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># 定义函数 g(x)</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>}</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co"># 定义函数 f1(x)</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="fu">drayleigh</span>(x, <span class="at">scale =</span> <span class="fl">1.5</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co"># 定义函数 f2(x)</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">1.5</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co"># 定义函数 rf1()，生成服从瑞利分布的随机样本</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>rf1 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>  <span class="fu">rrayleigh</span>(M, <span class="at">scale =</span> <span class="fl">1.5</span>)</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>}</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co"># 定义函数 rf2()，生成服从正态分布的随机样本</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>rf2 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>  <span class="fu">rnorm</span>(M, <span class="at">mean =</span> <span class="fl">1.5</span>)</span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>}</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co"># 定义函数 is.rayleigh()，估计瑞利分布的参数 theta1</span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a>is.rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">rf1</span>()  <span class="co"># 生成瑞利分布的随机样本</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">g</span>(xs)<span class="sc">/</span><span class="fu">f1</span>(xs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># 计算估计值，取平均并忽略缺失值</span></span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a>}</span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a><span class="co"># 定义函数 is.norm()，估计正态分布的参数 theta2</span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a>is.norm <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">rf2</span>()  <span class="co"># 生成正态分布的随机样本</span></span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">g</span>(xs)<span class="sc">/</span><span class="fu">f2</span>(xs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># 计算估计值，取平均并忽略缺失值</span></span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a>}</span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a></span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">is.rayleigh</span>()  <span class="co"># 估计瑞利分布的参数 theta1</span></span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">is.norm</span>()  <span class="co"># 估计正态分布的参数 theta2</span></span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a></span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a>theta1  <span class="co"># 打印估计的瑞利分布参数 theta1</span></span></code></pre></div>
<pre><code>## [1] 0.5025711</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>theta2  <span class="co"># 打印估计的正态分布参数 theta2</span></span></code></pre></div>
<pre><code>## [1] 0.5765356</code></pre>
<hr />
</div>
<div id="question-4-1" class="section level3">
<h3>Question 4</h3>
<ul>
<li>Question for 5.15</li>
</ul>
</div>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e4</span>  <span class="co"># 总样本量</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 重复次数</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># 分层数</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co"># 逆变换方法生成密度函数为 f_k(x) 的随机数</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co"># 注意 (a, b) 对应不同层的密度函数</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>inv_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {  </span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a) <span class="sc">-</span> (<span class="fu">exp</span>(<span class="sc">-</span>a) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>b)) <span class="sc">*</span> u)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>} </span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="co"># 使用 sapply 函数进行重复计算</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">inv_fun</span>(M, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  M1 <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># 重要抽样均值</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  M2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(k<span class="dv">-1</span>)){</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>    a <span class="ot">&lt;-</span> j <span class="sc">/</span> k</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>    b <span class="ot">&lt;-</span> (j <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> k</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>    xj <span class="ot">&lt;-</span> <span class="fu">inv_fun</span>(M <span class="sc">/</span> k, a, b)  <span class="co"># 生成分层随机数</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>    M2[j<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(<span class="sc">-</span>a) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>b)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> xj<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># 分层重要抽样均值</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>  }</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>  <span class="fu">c</span>(M1, <span class="fu">sum</span>(M2))</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>})</span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co"># 计算估计方差</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(res3[<span class="dv">1</span>,]), <span class="fu">var</span>(res3[<span class="dv">2</span>,]))  <span class="co"># 使用 SSE 方法估计方差</span></span></code></pre></div>
<pre><code>## [1] 1.056196e-06 3.028533e-08</code></pre>
<ul>
<li>第一个数据为：重要抽样均值，第二个数据为：分层重要抽样均值。</li>
</ul>
<hr />
</div>
<div id="question-5-1" class="section level3">
<h3>Question 5</h3>
<ul>
<li>Question for 6.5</li>
</ul>
</div>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>exercise_6_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># 样本量</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 置信水平</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># Monte Carlo 实验次数</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  cv.t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">FUN =</span> <span class="cf">function</span>(o) {</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>    c <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># t 分布的上 α/2 分位数</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)  <span class="co"># 均值估计</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(y))  <span class="co"># 标准误差估计</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    <span class="fu">as.numeric</span>((m <span class="sc">-</span> c <span class="sc">*</span> se <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (m <span class="sc">+</span> c <span class="sc">*</span> se <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="sc">&gt;</span> <span class="dv">0</span>))  <span class="co"># 置信区间</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>  })</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  level <span class="ot">&lt;-</span> <span class="fu">mean</span>(cv.t)  <span class="co"># Monte Carlo 实验的均值</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">level =</span> level))</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>}</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="fu">exercise_6_4</span>()</span></code></pre></div>
<pre><code>##   level
## 1 0.946</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>exercise_6_5 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  t_value <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># 0.975分位数的t-分布值，用于计算置信区间</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  cv.t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">FUN =</span> <span class="cf">function</span>(o) {</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">2</span>)  <span class="co"># 从自由度为2的卡方分布中抽取样本（注意这里的x是从卡方分布取样）</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>    mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)  <span class="co"># 样本均值的估计值</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))  <span class="co"># 样本标准误差的估计值</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>    <span class="fu">as.numeric</span>((mean_x <span class="sc">-</span> t_value <span class="sc">*</span> se <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="sc">&amp;</span> (mean_x <span class="sc">+</span> t_value <span class="sc">*</span> se <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="sc">&gt;</span> <span class="dv">2</span>))  <span class="co"># 计算置信区间</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  })</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  level1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(cv.t)  <span class="co"># Monte Carlo实验的均值，用于估计概率</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  <span class="co"># 我们可以得出概率不等于0.95，小于0.95。在example6.4中使用卡方分布来估计方差（真值为4）</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">2</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>    (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>  })</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  <span class="co"># 计算包含sigma^2=4的区间数</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>  level2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(UCL <span class="sc">&gt;</span> <span class="dv">4</span>) <span class="sc">/</span> m</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>  </span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(level1, level2))</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>}</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a><span class="fu">exercise_6_5</span>(<span class="dv">1012</span>)</span></code></pre></div>
<pre><code>##   level1 level2
## 1  0.908  0.794</code></pre>
<hr />
</div>
<div id="question-6" class="section level3">
<h3>Question 6</h3>
<ul>
<li>Question for 6.A</li>
</ul>
</div>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>exercise_6_A <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>)  <span class="co"># 不同样本量</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Monte Carlo 实验次数</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a> </span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  er <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> num) {</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>    cv <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># t 分布的上 0.975 分位数</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>    </span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>    <span class="co"># 估计卡方分布的第一类错误</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>    er1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">FUN =</span> <span class="cf">function</span>(o) {</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">1</span>)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>      m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>      se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>      <span class="fu">abs</span>((m <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n) <span class="sc">/</span> se) <span class="sc">&gt;=</span> cv</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>    }))</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>    </span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>    <span class="co"># 估计均匀分布的第一类错误</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>    er2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">FUN =</span> <span class="cf">function</span>(o) {</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>      m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>      se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>      <span class="fu">abs</span>((m <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n) <span class="sc">/</span> se) <span class="sc">&gt;=</span> cv</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>    }))</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>    </span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>    <span class="co"># 估计指数分布的第一类错误</span></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>    er3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">FUN =</span> <span class="cf">function</span>(o) {</span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>      m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a>      se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>      <span class="fu">abs</span>((m <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n) <span class="sc">/</span> se) <span class="sc">&gt;=</span> cv </span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a>    }))</span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a>    </span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a>    er <span class="ot">&lt;-</span> <span class="fu">cbind</span>(er, <span class="fu">c</span>(er1, er2, er3))</span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a>  }</span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a>  </span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a>  <span class="fu">colnames</span>(er) <span class="ot">&lt;-</span> num</span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a>  <span class="fu">rownames</span>(er) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;chi(1)&quot;</span>, <span class="st">&quot;U(0,2)&quot;</span>, <span class="st">&quot;exp(1)&quot;</span>)</span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a>  </span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a>  <span class="fu">return</span>(er)                </span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a>}</span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a><span class="fu">exercise_6_A</span>(<span class="dv">1012</span>)</span></code></pre></div>
<pre><code>##            50    100    200    500   1000
## chi(1) 0.0798 0.0654 0.0582 0.0560 0.0517
## U(0,2) 0.0443 0.0511 0.0506 0.0510 0.0528
## exp(1) 0.0644 0.0584 0.0548 0.0512 0.0531</code></pre>
<hr />
</div>
</div>
<div id="homework-5" class="section level2">
<h2>Homework 5</h2>
<hr />
<div id="question-1-3" class="section level3">
<h3>Question 1</h3>
<ul>
<li>考虑m=1000个假设，其中前95%个原假设成立，后5％个对立假设成立。在原假设之下，p-值服从U(0,1)分布，在对假设之下，p-值服从<span class="math inline">\(Beta(0.1,1)\)</span>分布（可用rbeta生成）应用Bonferrom校正与B—H校正应用于生成的m个P值（独立）（应用Padjust），得到校正后p-值，与<span class="math inline">\(\alpha＝0.1\)</span>比较确定是否拒绝原假设基于M＝1000次模拟，可估FWER，FDR，TPR,输生到表格中.</li>
</ul>
</div>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># 设置随机种子以确保结果可重复</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co"># 定义参数</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co"># 进行模拟</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>  <span class="co"># 生成m个p值</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(m <span class="sc">*</span> <span class="fl">0.95</span>), <span class="fu">rbeta</span>(m <span class="sc">*</span> <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>  </span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>  <span class="co"># Bonferroni校正</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  bonferroni_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  </span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>  <span class="co"># Benjamini-Hochberg校正</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>  bh_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>  </span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>  <span class="co"># 根据阈值确定是否拒绝原假设</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  bonferroni_reject <span class="ot">&lt;-</span> bonferroni_p <span class="sc">&lt;=</span> alpha</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>  bh_reject <span class="ot">&lt;-</span> bh_p <span class="sc">&lt;=</span> alpha</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>  </span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>  <span class="co"># 计算FWER、FDR和TPR</span></span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>  bonferroni_fwer <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_reject)</span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>  bonferroni_fdr <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_reject) <span class="sc">/</span> <span class="fu">sum</span>(bonferroni_reject)</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>  bonferroni_tpr <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_reject[<span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> <span class="fl">0.95</span>)]) <span class="sc">/</span> (m <span class="sc">*</span> <span class="fl">0.95</span>)</span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>  </span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>  bh_fwer <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_reject)</span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>  bh_fdr <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_reject) <span class="sc">/</span> <span class="fu">sum</span>(bh_reject)</span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>  bh_tpr <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_reject[<span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> <span class="fl">0.95</span>)]) <span class="sc">/</span> (m <span class="sc">*</span> <span class="fl">0.95</span>)</span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>  </span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>  <span class="co"># 返回结果</span></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>  <span class="fu">c</span>(bonferroni_fwer, bonferroni_fdr, bonferroni_tpr, bh_fwer, bh_fdr, bh_tpr)</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>})</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a><span class="co"># 计算平均FWER、FDR和TPR</span></span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>mean_bonferroni_fwer <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulations[<span class="dv">1</span>, ])</span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>mean_bonferroni_fdr <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulations[<span class="dv">2</span>, ])</span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a>mean_bonferroni_tpr <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulations[<span class="dv">3</span>, ])</span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a>mean_bh_fwer <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulations[<span class="dv">4</span>, ])</span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a>mean_bh_fdr <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulations[<span class="dv">5</span>, ])</span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a>mean_bh_tpr <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulations[<span class="dv">6</span>, ])</span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a><span class="co"># 输出结果表格</span></span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a>  <span class="at">FWER =</span> <span class="fu">c</span>(mean_bonferroni_fwer, mean_bh_fwer),</span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a>  <span class="at">FDR =</span> <span class="fu">c</span>(mean_bonferroni_fdr, mean_bh_fdr),</span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a>  <span class="at">TPR =</span> <span class="fu">c</span>( mean_bonferroni_tpr, mean_bh_tpr)</span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a>)</span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a><span class="fu">rownames</span>(result_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;Benjamini-Hochberg&quot;</span>)</span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a></span>
<span id="cb36-54"><a href="#cb36-54" tabindex="-1"></a><span class="fu">print</span>(result_table)</span></code></pre></div>
<pre><code>##                        FWER   FDR          TPR
## Bonferroni         0.019960 0.001 0.0001052632
## Benjamini-Hochberg 0.031372 0.001 0.0033094737</code></pre>
<hr />
</div>
<div id="question-2-3" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for PPT</li>
</ul>
</div>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># 设置λ的真实值</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>true_lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="co"># 设置样本大小</span></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a><span class="co"># 设置bootstrap重复次数</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a><span class="co"># 设置模拟次数</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a><span class="co"># 执行bootstrap估计的函数</span></span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>bootstrap_estimation <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, B) {</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>  bootstrap_estimates <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, B)</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>  </span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>    bootstrap_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample, <span class="at">size =</span> <span class="fu">length</span>(sample), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>    bootstrap_estimates[i] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(bootstrap_sample) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>  }</span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>  bootstrap_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_estimates)</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>  bootstrap_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_estimates)</span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>  </span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">bootstrap_mean =</span> bootstrap_mean, <span class="at">bootstrap_sd =</span> bootstrap_sd)</span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>}</span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a><span class="co"># 对每个样本大小进行模拟研究</span></span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sample_sizes, <span class="cf">function</span>(n) {</span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a>  <span class="fu">replicate</span>(m, {</span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a>    <span class="co"># 从指数分布生成样本</span></span>
<span id="cb38-33"><a href="#cb38-33" tabindex="-1"></a>    sample <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> true_lambda)</span>
<span id="cb38-34"><a href="#cb38-34" tabindex="-1"></a>    </span>
<span id="cb38-35"><a href="#cb38-35" tabindex="-1"></a>    <span class="co"># 执行bootstrap估计</span></span>
<span id="cb38-36"><a href="#cb38-36" tabindex="-1"></a>    bootstrap_results <span class="ot">&lt;-</span> <span class="fu">bootstrap_estimation</span>(sample, B)</span>
<span id="cb38-37"><a href="#cb38-37" tabindex="-1"></a>    </span>
<span id="cb38-38"><a href="#cb38-38" tabindex="-1"></a>    bootstrap_results</span>
<span id="cb38-39"><a href="#cb38-39" tabindex="-1"></a>  })</span>
<span id="cb38-40"><a href="#cb38-40" tabindex="-1"></a>})</span>
<span id="cb38-41"><a href="#cb38-41" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" tabindex="-1"></a><span class="co"># 计算平均bootstrap估计和bootstrap标准差</span></span>
<span id="cb38-43"><a href="#cb38-43" tabindex="-1"></a>mean_bootstrap_estimate <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results, <span class="cf">function</span>(x) <span class="fu">mean</span>(x[<span class="dv">1</span>, ]))</span>
<span id="cb38-44"><a href="#cb38-44" tabindex="-1"></a>mean_bootstrap_sd <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results, <span class="cf">function</span>(x) <span class="fu">mean</span>(x[<span class="dv">2</span>, ]))</span>
<span id="cb38-45"><a href="#cb38-45" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" tabindex="-1"></a><span class="co"># 计算理论偏差和标准误差</span></span>
<span id="cb38-47"><a href="#cb38-47" tabindex="-1"></a>theoretical_bias <span class="ot">&lt;-</span> true_lambda <span class="sc">/</span> (sample_sizes <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb38-48"><a href="#cb38-48" tabindex="-1"></a>theoretical_se <span class="ot">&lt;-</span> true_lambda <span class="sc">*</span> sample_sizes <span class="sc">/</span> ((sample_sizes <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(sample_sizes <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb38-49"><a href="#cb38-49" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" tabindex="-1"></a><span class="co"># 创建数据框来存储结果</span></span>
<span id="cb38-51"><a href="#cb38-51" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-52"><a href="#cb38-52" tabindex="-1"></a>  样本大小 <span class="ot">=</span> sample_sizes,</span>
<span id="cb38-53"><a href="#cb38-53" tabindex="-1"></a>  平均Bootstrap估计 <span class="ot">=</span> mean_bootstrap_estimate,</span>
<span id="cb38-54"><a href="#cb38-54" tabindex="-1"></a>  平均Bootstrap标准差 <span class="ot">=</span> mean_bootstrap_sd,</span>
<span id="cb38-55"><a href="#cb38-55" tabindex="-1"></a>  理论偏差 <span class="ot">=</span> theoretical_bias,</span>
<span id="cb38-56"><a href="#cb38-56" tabindex="-1"></a>  理论标准误差 <span class="ot">=</span> theoretical_se</span>
<span id="cb38-57"><a href="#cb38-57" tabindex="-1"></a>)</span>
<span id="cb38-58"><a href="#cb38-58" tabindex="-1"></a></span>
<span id="cb38-59"><a href="#cb38-59" tabindex="-1"></a><span class="fu">print</span>(result_table)</span></code></pre></div>
<pre><code>##   样本大小 平均Bootstrap估计 平均Bootstrap标准差  理论偏差 理论标准误差
## 1        5         0.5998165           2.2951510 0.5000000    1.4433757
## 2       10         0.2212391           0.8289639 0.2222222    0.7856742
## 3       20         0.1024373           0.4994832 0.1052632    0.4962153</code></pre>
<ul>
<li>可见随着样本数量的增加，预测得更加准确。</li>
</ul>
<hr />
</div>
<div id="question-3-3" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 7.3</li>
</ul>
</div>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>example_7_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">1012</span>) {</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  </span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="co"># 定义boot.t.ci函数，用于计算bootstrap t置信区间</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  boot.t.ci <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">B =</span> <span class="dv">500</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">level =</span> <span class="fl">0.95</span>, statistic) {</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>    stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co"># 存储bootstrap样本的统计量</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co"># 存储bootstrap样本的标准误差</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>    </span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>    <span class="co"># 定义boot.se函数，用于计算bootstrap样本的标准误差</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>    boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, f) {</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>      th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>        i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x), <span class="at">size =</span> <span class="fu">nrow</span>(x), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>        <span class="fu">f</span>(x[i, ])</span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a>      })</span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>      <span class="fu">sd</span>(th) <span class="co"># 返回bootstrap样本的标准差</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>    }</span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>    </span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a>      y <span class="ot">&lt;-</span> x[<span class="fu">sample</span>(<span class="fu">nrow</span>(x), <span class="at">replace =</span> <span class="cn">TRUE</span>), ] <span class="co"># 构建bootstrap样本</span></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a>      stat[b] <span class="ot">&lt;-</span> <span class="fu">statistic</span>(y) <span class="co"># 计算bootstrap样本的统计量</span></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>      se[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(y, <span class="at">R =</span> R, <span class="at">f =</span> statistic) <span class="co"># 计算bootstrap样本的标准误差</span></span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a>    }</span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a>    </span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a>    stat0 <span class="ot">&lt;-</span> <span class="fu">statistic</span>(x) <span class="co"># 原始样本的统计量</span></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a>    t.stats <span class="ot">&lt;-</span> (stat <span class="sc">-</span> stat0) <span class="sc">/</span> se <span class="co"># 计算t统计量</span></span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a>    se0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat) <span class="co"># 原始样本的标准误差</span></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a>    Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">type =</span> <span class="dv">1</span>) <span class="co"># 计算t统计量的分位数</span></span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a>    CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat0 <span class="sc">-</span> Qt <span class="sc">*</span> se0) <span class="co"># 构建置信区间</span></span>
<span id="cb40-30"><a href="#cb40-30" tabindex="-1"></a>    </span>
<span id="cb40-31"><a href="#cb40-31" tabindex="-1"></a>    CI</span>
<span id="cb40-32"><a href="#cb40-32" tabindex="-1"></a>  }</span>
<span id="cb40-33"><a href="#cb40-33" tabindex="-1"></a>  </span>
<span id="cb40-34"><a href="#cb40-34" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(law<span class="sc">$</span>LSAT, law<span class="sc">$</span>GPA) <span class="co"># 原始数据集</span></span>
<span id="cb40-35"><a href="#cb40-35" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="cf">function</span>(dat) {</span>
<span id="cb40-36"><a href="#cb40-36" tabindex="-1"></a>    <span class="fu">mean</span>(<span class="fu">cor</span>(dat[, <span class="dv">1</span>], dat[, <span class="dv">2</span>])) <span class="co"># 统计量函数，计算LSAT和GPA的相关系数的均值</span></span>
<span id="cb40-37"><a href="#cb40-37" tabindex="-1"></a>  }</span>
<span id="cb40-38"><a href="#cb40-38" tabindex="-1"></a>  </span>
<span id="cb40-39"><a href="#cb40-39" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.t.ci</span>(dat, <span class="at">B =</span> <span class="dv">2000</span>, <span class="at">R =</span> <span class="dv">200</span>, <span class="at">statistic =</span> stat) <span class="co"># 执行bootstrap t置信区间计算</span></span>
<span id="cb40-40"><a href="#cb40-40" tabindex="-1"></a>  <span class="fu">print</span>(ci) <span class="co"># 输出结果</span></span>
<span id="cb40-41"><a href="#cb40-41" tabindex="-1"></a>}</span>
<span id="cb40-42"><a href="#cb40-42" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" tabindex="-1"></a><span class="fu">example_7_3</span>() <span class="co"># 调用示例函数</span></span></code></pre></div>
<pre><code>##      97.5%       2.5% 
## -0.3152423  0.9981904</code></pre>
<hr />
</div>
</div>
<div id="homework-6" class="section level2">
<h2>Homework 6</h2>
<hr />
<div id="question-1-4" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Question for 7.5</li>
</ul>
</div>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">library</span>(boot) </span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>example_7_5 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">1023</span>) {</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours  <span class="co"># 获取数据集 aircondit 中的 hours 列作为输入数据</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  </span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  theta.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, ind) {</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>    <span class="fu">mean</span>(dat[ind])</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  }</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  </span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(dat, <span class="at">statistic =</span> theta.boot, <span class="at">R =</span> <span class="dv">2000</span>)  <span class="co"># 进行自助法计算</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  </span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  <span class="fu">print</span>(boot.obj) </span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>)))  <span class="co"># 输出自助法置信区间</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>}</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a><span class="fu">example_7_5</span>()</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = dat, statistic = theta.boot, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 -1.801667    39.14081
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.2, 186.6 )   ( 24.9, 172.5 )  
## 
## Level     Percentile            BCa          
## 95%   ( 43.7, 191.2 )   ( 55.5, 246.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<ul>
<li>Bca方法产生的区间较大，不同的方法会得到不同的结果。</li>
<li>Bootstrap t置信区间具有二阶精度，但不考虑变换。</li>
<li>Bootstrap百分位区间具有一阶精度，但仅限于一阶精度。</li>
<li>标准正态置信区间既不具备一阶精度也不具备二阶精度。</li>
</ul>
<hr />
</div>
<div id="question-2-4" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 7.8</li>
</ul>
</div>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>  <span class="fu">library</span>(bootstrap)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>example_7_8 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">1023</span>) {</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  </span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  sc <span class="ot">&lt;-</span> scor</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>  </span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)  <span class="co"># 计算协方差矩阵</span></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>    pca.sigma <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sigma)  <span class="co"># 进行主成分分析</span></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> pca.sigma<span class="sc">$</span>sdev[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(pca.sigma<span class="sc">$</span>sdev)  <span class="co"># 获取主成分分析的第一个特征值占比</span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>    theta</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>  }</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>  </span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">NROW</span>(sc)</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  theta.j <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  </span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>  <span class="co"># 计算每个样本的 theta 值</span></span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>    theta.j[i] <span class="ot">&lt;-</span> <span class="fu">theta</span>(sc[<span class="sc">-</span>i, ])</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>  }</span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>  </span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> <span class="fu">theta</span>(sc)</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>  </span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.j) <span class="sc">-</span> theta.hat)  <span class="co"># 计算偏差</span></span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(theta.j))  <span class="co"># 计算标准误差</span></span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a>  </span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Bias.jack =</span> bias, <span class="at">SE.jack =</span> se)</span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a>}</span>
<span id="cb46-30"><a href="#cb46-30" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" tabindex="-1"></a><span class="fu">example_7_8</span>()</span></code></pre></div>
<pre><code>## $Bias.jack
## [1] 0.01433958
## 
## $SE.jack
## [1] 0.05299504</code></pre>
<hr />
</div>
<div id="question-3-4" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 7.11</li>
</ul>
</div>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)  <span class="co"># magneti和chemical是数据集中的向量，在DAAG ironslag中</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k, k<span class="sc">+</span><span class="dv">1</span>)]  <span class="co"># 离开两个样本后的目标变量</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k, k<span class="sc">+</span><span class="dv">1</span>)]  <span class="co"># 离开两个样本后的特征变量</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  </span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)  <span class="co"># 拟合线性模型</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] </span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1 </span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  </span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># 拟合二次模型</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2 </span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>  </span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)  <span class="co"># 拟合对数线性模型</span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] </span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)  </span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3 </span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>  </span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))  <span class="co"># 拟合对数对数模型</span></span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])  </span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4) </span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4  </span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a>}</span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a><span class="co"># 输出平均平方误差</span></span>
<span id="cb49-28"><a href="#cb49-28" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 20.45882 18.60195 19.22315 21.34034</code></pre>
<ul>
<li>可见二次模型的误差最小。</li>
</ul>
<hr />
</div>
</div>
<div id="homework-7" class="section level2">
<h2>Homework 7</h2>
<hr />
<div id="question-1-5" class="section level3">
<h3>Question 1</h3>
<ul>
<li>连续情况下Metropolis-Hastings采样算法的平稳性证明。</li>
</ul>
</div>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<ul>
<li>算法描述：</li>
</ul>
<p>假设目前已经采样到 <span class="math inline">\(X_{n}=i\)</span>
，那么下一个采样 <span class="math inline">\(X_{n+1}\)</span>
的计算公式如下。 1. 采样 <span class="math inline">\(Y=j\)</span> ，其中
<span class="math inline">\(Y=j\)</span> 的 PDF 为 <span class="math inline">\(f(j)=q_{i j}\)</span> 2. 计算提议概率:</p>
<p><span class="math inline">\(a_{i j}=\min \left(1, \frac{\pi_{j} q_{j
i}}{\pi_{i} q_{i j}}\right)\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li>采样 <span class="math inline">\(u \sim U(0,1)\)</span> ， <span class="math inline">\(X_{n+1}\)</span> 为: <span class="math display">\[
X_{n+1}=\left\{\begin{array}{ll}
Y &amp; u&lt;a_{i j} \\
X_{n} &amp; u \geq a_{i j}
\end{array}\right.
\]</span></li>
</ol>
<ul>
<li>细致平稳性证明：</li>
</ul>
<p>我们首先证明 <span class="math inline">\(p_{i j}=q_{i j} a_{i
j}\)</span> 。 根据采样规则: (1) <span class="math inline">\(i \neq
j\)</span> 时</p>
<span class="math display">\[\begin{aligned}
\mathbb{P}\left(X_{n+1}=j \mid X_{n}=i\right) &amp;
=\mathbb{P}\left(X_{n}=j \mid X_{n}=i\right) \mathbb{P}\left(u \geq a_{i
j}\right)+\mathbb{P}\left(Y=j \mid X_{n}=i\right)
\mathbb{P}\left(u&lt;a_{i j}\right) \\
&amp; =\mathbb{P}\left(Y=j \mid X_{n}=i\right) \mathbb{P}\left(u&lt;a_{i
j}\right) \\
&amp; =q_{i j} a_{i j}
\end{aligned}\]</span>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(i=j\)</span> 时， <span class="math inline">\(a_{i j}=a_{i i}=1\)</span></li>
</ol>
<span class="math display">\[\begin{aligned}
\mathbb{P}\left(X_{n+1}=j \mid X_{n}=i\right) &amp;
=\mathbb{P}\left(X_{n}=j \mid X_{n}=i\right) \mathbb{P}\left(u \geq a_{i
j}\right)+\mathbb{P}\left(Y=j \mid X_{n}=i\right)
\mathbb{P}\left(u&lt;a_{i j}\right) \\
&amp; =\mathbb{P}\left(u \geq a_{i j}\right)+\mathbb{P}\left(Y=j \mid
X_{n}=i\right) \mathbb{P}\left(u&lt;a_{i j}\right) \\
&amp; =1-a_{i j}+q_{i j} a_{i j} \\
&amp; =q_{i j}
\end{aligned}\]</span>
<p>综上:</p>
<p><span class="math inline">\(p_{i j}=q_{i j} a_{i j}\)</span></p>
<p>下考察细致平稳条件：</p>
<span class="math display">\[\begin{aligned}
\pi_{i} p_{i j} &amp; =\pi_{i} q_{i j} a_{i j} \\
&amp; =\pi_{i} q_{i j} \min \left(1, \frac{\pi_{j} q_{j i}}{\pi_{i} q_{i
j}}\right) \\
&amp; =\min \left(\pi_{i} q_{i j}, \pi_{j} q_{j i}\right) \\
&amp; =\pi_{j} q_{j i} \min \left(1, \frac{\pi_{i} q_{i j}}{\pi_{j} q_{j
i}}\right) \\
&amp; =\pi_{j} q_{j i} a_{j i} \\
&amp; =\pi_{j} p_{j i}
\end{aligned}\]</span>
<hr />
</div>
<div id="question-2-5" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 8.1</li>
</ul>
</div>
<div id="answer-21" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>  <span class="fu">library</span>(RVAideMemoire)</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>feed1 <span class="ot">=</span> <span class="st">&quot;soybean&quot;</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>feed2 <span class="ot">=</span> <span class="st">&quot;linseed&quot;</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> chickwts</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a><span class="co"># 提取大豆饲料和亚麻籽饲料的体重数据</span></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">sort</span>(data<span class="sc">$</span>weight[data<span class="sc">$</span>feed <span class="sc">==</span> feed1])[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>ys <span class="ot">&lt;-</span> <span class="fu">sort</span>(data<span class="sc">$</span>weight[data<span class="sc">$</span>feed <span class="sc">==</span> feed2])[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>rep <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a><span class="co"># 将两组数据合并为一个向量</span></span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>zs <span class="ot">&lt;-</span> <span class="fu">c</span>(xs, ys)</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(xs)</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(ys)</span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>Ts <span class="ot">&lt;-</span> <span class="fu">numeric</span>(rep)</span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a><span class="co"># 进行重复次数为rep的循环</span></span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>  <span class="co"># 从合并的数据中随机选择n1个样本，作为第一组样本</span></span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a>  ks <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n1, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>  zs1 <span class="ot">&lt;-</span> zs[ks]</span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a>  zs2 <span class="ot">&lt;-</span> zs[<span class="sc">-</span>ks]</span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>  Ts[i] <span class="ot">&lt;-</span> <span class="fu">cramer.test</span>(zs1, zs2)<span class="sc">$</span>statistic</span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>}</span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a><span class="co"># 计算Cramer-von Mises检验的统计量和p值</span></span>
<span id="cb52-31"><a href="#cb52-31" tabindex="-1"></a>cvm <span class="ot">&lt;-</span> <span class="fu">cramer.test</span>(xs, ys)</span>
<span id="cb52-32"><a href="#cb52-32" tabindex="-1"></a>T.hat <span class="ot">&lt;-</span> cvm<span class="sc">$</span>statistic</span>
<span id="cb52-33"><a href="#cb52-33" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(T.hat) <span class="sc">&lt;</span> <span class="fu">abs</span>(Ts))</span>
<span id="cb52-34"><a href="#cb52-34" tabindex="-1"></a></span>
<span id="cb52-35"><a href="#cb52-35" tabindex="-1"></a><span class="fu">hist</span>(Ts)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-3-5" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 8.2</li>
</ul>
</div>
<div id="answer-22" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>n2 <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="co"># 返回H1的概率，其中H0是等方差（即sd1 = sd2）</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>test_equal_variance <span class="ot">=</span> <span class="cf">function</span>(xs1, xs2){</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  <span class="co"># 让x1小于x2</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xs2) <span class="sc">&lt;</span> <span class="fu">length</span>(xs1)) {</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>    tmp <span class="ot">=</span> xs1</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>    xs1 <span class="ot">=</span> xs2</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>    xs2 <span class="ot">=</span> tmp</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  }</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  n1 <span class="ot">=</span> <span class="fu">length</span>(xs1)</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>  n2 <span class="ot">=</span> <span class="fu">length</span>(xs2)</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  </span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>  ys <span class="ot">=</span> <span class="fu">c</span>(xs1, xs2)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>  </span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>  <span class="co"># 如果一个样本中有超过五个值位于另一个样本的范围之外，返回1。这意味着样本之间的方差不同。</span></span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  count5 <span class="ot">=</span> <span class="cf">function</span> (ys1, ys2) {</span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(ys1) <span class="sc">==</span> <span class="fu">length</span>(ys2))</span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>    extr1 <span class="ot">=</span> <span class="fu">sum</span>((ys1 <span class="sc">&lt;</span> <span class="fu">min</span>(ys2))) <span class="sc">+</span> <span class="fu">sum</span>((ys1 <span class="sc">&gt;</span> <span class="fu">max</span>(ys2)))</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>    extr2 <span class="ot">=</span> <span class="fu">sum</span>((ys2 <span class="sc">&lt;</span> <span class="fu">min</span>(ys1))) <span class="sc">+</span> <span class="fu">sum</span>((ys2 <span class="sc">&gt;</span> <span class="fu">max</span>(ys1)))</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>    </span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>    out <span class="ot">=</span> <span class="fu">max</span>(extr1, extr2)</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">as.integer</span>(out <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>  }</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>  </span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>  <span class="co"># 运行排列检验。</span></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>  <span class="co"># 如果H0成立，对于ys中的“大多数”（取决于所需的p值）等大小的2个样本集，count 5必须返回0。</span></span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>  rep <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>  n.min <span class="ot">=</span> n1</span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(ys)</span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>  c5s <span class="ot">=</span> <span class="fu">numeric</span>(rep)</span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>  size <span class="ot">=</span> <span class="fu">floor</span>(n <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>  </span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a>    k <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, size, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>    ys1 <span class="ot">=</span> ys[k]</span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>    ys2 <span class="ot">=</span> ys[<span class="sc">-</span>k]</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>    <span class="co"># 计算count 5测试返回1（即不同方差）的次数</span></span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>    c5s[i] <span class="ot">=</span> <span class="fu">count5</span>(ys1, ys2)</span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>  }</span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a>  </span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>  <span class="fu">hist</span>(c5s, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a>  </span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a>  <span class="co"># 根据count 5测试的不同方差频率返回结果</span></span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(c5s))</span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a>}</span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a></span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a>mean <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb53-50"><a href="#cb53-50" tabindex="-1"></a><span class="co"># 使用不同标准差的不同大小的随机正态分布样本进行算法测试</span></span>
<span id="cb53-51"><a href="#cb53-51" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">test_equal_variance</span>(<span class="fu">rnorm</span>(n1, mean, <span class="dv">1</span>), <span class="fu">rnorm</span>(n2, mean, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">test_equal_variance</span>(<span class="fu">rnorm</span>(n1, mean, <span class="dv">10</span>), <span class="fu">rnorm</span>(n2, mean, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>result3 <span class="ot">&lt;-</span> <span class="fu">test_equal_variance</span>(<span class="fu">rnorm</span>(n1, mean, <span class="dv">100</span>), <span class="fu">rnorm</span>(n2, mean, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>result1</span></code></pre></div>
<pre><code>## [1] 0.132</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>result2</span></code></pre></div>
<pre><code>## [1] 0.115</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>result3</span></code></pre></div>
<pre><code>## [1] 0.137</code></pre>
<hr />
</div>
</div>
<div id="homework-8" class="section level2">
<h2>Homework 8</h2>
<hr />
<div id="question-1-6" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Question for homework</li>
</ul>
</div>
<div id="answer-23" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>  <span class="co"># 导入所需的包</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># 第一步：设计函数，计算a的值</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>calculate_a <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0) {</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  <span class="co"># 生成随机变量 X1, X2, X3</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子，以确保可重现性</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="dv">1</span>)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  X3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  </span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="co"># 计算 Y=1 的概率</span></span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(a) {</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>    P_Y1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(a <span class="sc">+</span> b1<span class="sc">*</span>X1 <span class="sc">+</span> b2<span class="sc">*</span>X2 <span class="sc">+</span> b3<span class="sc">*</span>X3) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(a <span class="sc">+</span> b1<span class="sc">*</span>X1 <span class="sc">+</span> b2<span class="sc">*</span>X2 <span class="sc">+</span> b3<span class="sc">*</span>X3))</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>    <span class="fu">mean</span>(P_Y1) <span class="sc">-</span> f0</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>  }, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>))<span class="sc">$</span>root</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>  </span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>}</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a><span class="co"># 第二步：输入参数</span></span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a><span class="co"># 计算 a 的值</span></span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(f0, <span class="cf">function</span>(f) <span class="fu">calculate_a</span>(N, b1, b2, b3, f))</span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" tabindex="-1"></a><span class="co"># 第三步：绘制图形</span></span>
<span id="cb63-29"><a href="#cb63-29" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="sc">-</span><span class="fu">log</span>(f0), a_values)</span>
<span id="cb63-30"><a href="#cb63-30" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;-log f0&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb63-31"><a href="#cb63-31" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log</span>(f0))) <span class="sc">+</span></span>
<span id="cb63-32"><a href="#cb63-32" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb63-33"><a href="#cb63-33" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-34"><a href="#cb63-34" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;a&quot;</span>, <span class="at">y =</span> <span class="st">&quot;-log f0&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-35"><a href="#cb63-35" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-2-6" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 9.4</li>
</ul>
</div>
<div id="answer-24" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>is <span class="ot">&lt;-</span> <span class="dv">5000</span><span class="sc">:</span><span class="dv">5500</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>mc.laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(sd) {</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  <span class="co"># 定义标准拉普拉斯分布函数</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  }</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>  <span class="co"># 定义生成随机数的函数</span></span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>  rg <span class="ot">&lt;-</span> <span class="cf">function</span>(mean) {</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>  }</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>  <span class="co"># Metropolis-Hastings算法</span></span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a>  rw <span class="ot">&lt;-</span> <span class="cf">function</span>(N, df, rg) {</span>
<span id="cb64-19"><a href="#cb64-19" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb64-20"><a href="#cb64-20" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rg</span>(<span class="dv">1</span>)</span>
<span id="cb64-21"><a href="#cb64-21" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-22"><a href="#cb64-22" tabindex="-1"></a>    us <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb64-23"><a href="#cb64-23" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb64-25"><a href="#cb64-25" tabindex="-1"></a>      xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb64-26"><a href="#cb64-26" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rg</span>(xt)</span>
<span id="cb64-27"><a href="#cb64-27" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">df</span>(y) <span class="sc">/</span> <span class="fu">df</span>(xt)</span>
<span id="cb64-28"><a href="#cb64-28" tabindex="-1"></a>      <span class="cf">if</span> (us[i] <span class="sc">&lt;=</span> res) {</span>
<span id="cb64-29"><a href="#cb64-29" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb64-30"><a href="#cb64-30" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb64-31"><a href="#cb64-31" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb64-32"><a href="#cb64-32" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb64-33"><a href="#cb64-33" tabindex="-1"></a>      }</span>
<span id="cb64-34"><a href="#cb64-34" tabindex="-1"></a>    }</span>
<span id="cb64-35"><a href="#cb64-35" tabindex="-1"></a>    <span class="fu">print</span>(k)</span>
<span id="cb64-36"><a href="#cb64-36" tabindex="-1"></a></span>
<span id="cb64-37"><a href="#cb64-37" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb64-38"><a href="#cb64-38" tabindex="-1"></a>  }</span>
<span id="cb64-39"><a href="#cb64-39" tabindex="-1"></a></span>
<span id="cb64-40"><a href="#cb64-40" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rw</span>(N, df, rg))</span>
<span id="cb64-41"><a href="#cb64-41" tabindex="-1"></a>}</span>
<span id="cb64-42"><a href="#cb64-42" tabindex="-1"></a></span>
<span id="cb64-43"><a href="#cb64-43" tabindex="-1"></a><span class="co"># 绘制图形</span></span>
<span id="cb64-44"><a href="#cb64-44" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">mc.laplace</span>(<span class="at">sd =</span> sds[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1783</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="fu">length</span>(sds), <span class="dv">1</span>))</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))  <span class="co"># 调整边距值以减小边距的大小</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a><span class="fu">plot</span>(is, xs[is], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="fu">paste</span>(<span class="st">&quot;标准差 = &quot;</span>, sds[<span class="dv">1</span>], <span class="at">sep =</span> <span class="st">&#39;&#39;</span>))</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(sds)) {</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">mc.laplace</span>(<span class="at">sd =</span> sds[i])</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  <span class="fu">plot</span>(is, xs[is], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="fu">paste</span>(<span class="st">&quot;标准差 = &quot;</span>, sds[i], <span class="at">sep =</span> <span class="st">&#39;&#39;</span>))</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 2997</code></pre>
<pre><code>## [1] 4696</code></pre>
<pre><code>## [1] 6563</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="question-3-6" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 9.7</li>
</ul>
</div>
<div id="answer-25" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>mean12 <span class="ot">&lt;-</span> <span class="cf">function</span>(x2) mu1 <span class="sc">+</span> rho <span class="sc">*</span> sigma1 <span class="sc">/</span> sigma2 <span class="sc">*</span> (x2 <span class="sc">-</span> mu2)</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>mean21 <span class="ot">&lt;-</span> <span class="cf">function</span>(x1) mu2 <span class="sc">+</span> rho <span class="sc">*</span> sigma2 <span class="sc">/</span> sigma1 <span class="sc">*</span> (x1 <span class="sc">-</span> mu1)</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>,]</span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a>  xt[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean12</span>(xt[<span class="dv">2</span>]), s1)</span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>  xt[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean21</span>(xt[<span class="dv">1</span>]), s2)</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a>  x[i,] <span class="ot">&lt;-</span> xt</span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a>}</span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a></span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,]</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a>lin.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(X1 <span class="sc">~</span> X2, <span class="at">data =</span> x)</span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb71-32"><a href="#cb71-32" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">&quot;生成的数据&quot;</span>)  </span>
<span id="cb71-33"><a href="#cb71-33" tabindex="-1"></a><span class="fu">hist</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;线性模型的残差&quot;</span>)  </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABF1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtmAABmADpmOgBmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQZmaQkGaQkJCQkLaQkNuQtraQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa2tma2tpC2tra2ttu225C227a229u22/+2/7a2/9u2///T09PbkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb2//b/7bb/9vb////tmb/tpD/trb/25D/27b/29v//7b//9v///8jcMjZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAP2klEQVR4nO2dDVvbRhLH17zcoVxNAhdcci00pOAUQtpcMYVcUS6lpU5DGqdntSaSvv/nuJldvRrJs9KuhQLzf/I4xl7vjn6amV1Jq5UIWTMlbtqAtosBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCE6gAadh+OZ5fwuutQIjjYOk8/O+nuwuuxfI0K7Yw9seaCTrsbGu0GL59DrZPuWlrrcfeJ/OZ0O/nsz62dcRjsrx4N1XdFlpWYKPWmu5tu3eVWVUAnqy/Cobi2OcHT7uNnXyUVqxITp3MUt7p6NBC7/c7XPbGX2CqWAdCKKr+u0bbfw/omztJJJ2YUmRL0O5lqsa5B5ygx8x3uA/dYLJzjtyvFJr5TZZbHQ/FgM90Fw4qA/B7UWwAoHIiNtDHYLxep9dG2fSaEWJk4ywlFtDUBpONBqpTfw43IbGbguv/rJ7sCqty4ct1+Z+dEPOhF9Q7EHhAD57t/Ev3yuolYKKrSEwsXseEVAckNVLV+HGW/AEDhsVjHz4L9bnf7x+7q615nx/0xonbc/Ux01sbqp6NoS6oB8jeXfoGI8Htg/eXhOAEE8L/LAwqlB3lppRLQzujSWVENFpkYRHXAz4KDbVk9elVFQAPMGfv4cipU+xNn9TsXP1t23RMhdqOWgOQJFpg4uDPeQ4m+WNsUAgxyN8XKOJClQcuu/LUGoKHYg9rOr4DHWW9xFaNgdCzE0jNnGT0oGH0Iw6japV9Ot8eTLQUN/Uk87MvWYkDXTQz9R6sXCtAKVLsUB1k1QLATL6b2d1R9EttJ6397dH+cfD2CHwE8zCLxnko8CBL1swf/JtuedNdHAPnwdS/1/8Oe3Oy1s83OzjdC1Sud6mAbuT/qyqAZjcGfZIg5eUA5EyG3QQ5a3PpSLCNquSXvqnqQJ8O0GBDE3rtXGUCd1e/T1uF7lAMb4ccbiLa+TcOM0kAsbWLD8veB+0q2reCk0LF1GXXYRvBU+QR8tnBRBChnIjioTEOyxCjJH5UARbFZBAj/81VOjP33NZaOsjL8941EhGES5WlPLELiXoOYWD7b1EpCcof7/c6D7f3VrRfIAuIcPCvMAEJoS5BbIO7PoqBBMGERoKyJwdN7u/Jj2NVn+13orGsAupSZXwH6OBpHjYMtT8U/e9ivyk2HZnbcU7AJ+xrV+p8wJDlePfrr8OfDbxOHeSM6u8N4l2kI6v3+dGvHBY8JVRCMRpBEfgOjApmDxso40KKT9SC53egcwbvRmxjQtIkIFjbiAYbY+ZWLKUj2/BWT9EeVUtcg9UebhdWjBTjMSQYlcmdJr5KtB+6HaMQBPniiSl1Cxlb7VRNQMBA77sHjc9xUT0TjnqF4OAKLIMweY+qHUuCoDw++dLIe9OYetPzyELb5IyT1vWITD7Z/d9AiDM9f+mI9Ho3UGknnQ0wBwj23kO4wbB1Tsto972Q3d+rcH2MxNNHH9LoCQdJZgxA71hgoQhZbeqGaX3TicaE0ZTROQwxz3QYGI2S34AeZYy4PZY90efgTvCrXu27iR3ccjuRISAbuStqqOaAV2R66qLI6DvBx6LoqeYfByN9cuMDfeSIZhHk4bhTye51xUBAnzgmm+uivYcZp5ZvD5148clgDx5JeFVu9niSGAhPDuI/GIE1Gs/4jY0Be3GkMZD8GOyJtPQyT1uE3spTfS34MgNCfdAHJDXv/0h2/lT6y9aQIEACI07BID2qusolhnAOUMTGubIjjhb9cZAVZzBjQEIYmpw4eVQmxLru5qdajof37feixPkC/nuweT/z96eqZowko+G2rK9ZejK/2xQNH7HrJcUEOUNIiJJfN9LPRVBuFJqpO8qovPhNLFy+fKz7nBoCuXNk7ro3B5zc8Z/l9TyxClxt3EYnnqB9dbXa2nA50ESdqlBqM3qpOf+k7vZH0G+jYw+DYgQNJjMzrgKJuzFOZFqvu7GZ+r4oGsn8qMlH2ecGps/4Bg2wRNuTq0dq4UpIO1GGxOtSA+tEStSeDN/eeIAOZ3dLd834z3pCPx52dMUICk6EnuX8eBnBI0HkY7UbdELtyf1KWHIs4HNZd1YvtnPWUbyIg1ZAcR57L45zE6r7s/4pMPF09D87+9Vwygy4Wuh731VXlbn5a/sG3aO/L6HTMFZ6xCU63Vc8uDXmivscNu3y0o44BX8n/Rv8BF5zI0zJvt45KGiiVcpfM6aVYXndpv6saCl4equOcaRWZeJg7xxUfbfAZRUoMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQpYBiVLZbac52QbUUDvNqRlA7EGzqxPsQbOrawWgml7cAKCWJGnxa0sBKTx3CZAnRKdszmUhoPDuABrg7Uf3x6Hf2ysucMdDbLA8lvfnhOFweVxYoizE7gYg6TcTvLco9JLbIlUt5QNmcYc8yO/Jyfw4xVrfg1pzqNFEiA1jv1Go9KprCSDRSJIexreWl+ToFntQM4BqVMeAZlfXmtMdDIhQSwG154RZOwEJ9qDZ1aV0Krfj9zTXG9BUOwGlhGq0MxRC805NHbUcUM0Qs8ionYDMr2qkCzoY6lYCwnvx98KgX3LgV82yNgISJoBwdY/ozn8bLtRGQBk61QGpJe/qmnF9v9wsoGJHyTrQDY2D2gKopLqsC1WvC89feoadWKsB5dynejsDmYD8ntFwsc2ARGgEKL4uYJahbzGgoK+Ca2gHkGgfINMQG8rTlhPHKAnlAdXZ2PYCUqsEGfT1OXvaDch+O5XtYUCEPS0EJAwBBWp5WrND1U8EUL1xkJUjsIw1twxQ6bXJeva0G1BY41CjdAJJPXtuH6Cgb+OUdIsBCcMQm3F9OxWZyJsF5PfSTS4xqRBQ1Xbyjc3I1cnyi6UH/Q17EK7sXVxLDsbUR/UAaZmTYCGn4zQUYmRiyBo0d0CZPF52zN94DqISQ1ydsADIx7VHBzM6+xZ6kHZ1wjzEvM4RbPbM4dAw3l1tyUEVqjP2IHQP9IuZ54PiTF56XcgeoHgpdYsnqHKEag0UEZClM4qmgHBunTr9awdQDk8tQLEHDYyuGtoCpNKdvIRpH5BRDhrO7BUaGyjGHSbsrjl4UM5SfckEM/OMYnMDxaTDHKxYAXTNgT75gWKMBfbapwOofKA41XhopReLH4rREkAax2Kf8EDRngfN7OVvZqD4g2UPKmtHU4NZR3/aA0Vh2ot9Ff8dPw+spuwDsjNQNAYUT8YZ1MvR0/FkEZC9YYdRiMGIa0VeyzQ8z2kdkM7sjolTOpi0BgjzXOdL0wu9RYCm29EVmV4qneGMANUglP5EOZGh7AHSkRc/qFPXg0wADdGDjK/VNQtIPpS2GUBq4n/m4V81dQ3QtKXa0ogflHq249wBmfZi+eoKHKj2ZZ/ZR/OywEYTgKyOg6wACvrRYx6p80ETZ7GRHJTIfCRtBZD/efQ8X3KHQe/SKCAjibBwFGTgQXbOKLYWkEE7nlriwWxodpsBqX7M8D6WZgFpjlzthJgdNexB9Nm0a4DmO1Ak1XSIaV2bz+ExAEReetZQ4zlI59q8pRDTuPRMqy1JOgukMEfP6dIzbVjGwLb0YoV8bvrSc6OAMhcTiqqz7EGf4EBxNqDCDFQ/B5EHq7PVckBm7dCXnmlNA6qOaK4hZtaODU0Dqn7PWGsBzWpFXzcCaHZ1xXzq9WL1zcjboN62DpBhO3aWE1Cvv95CQDoTyXXska+3EZAte+QrAyq3R77eOkB27oUK2w3IpB0JyEZHz4BIe+RriwCVRNhdBySKZNDOrQOUqS7Bw4CKq+MQI6qzBCiN1Fs2kraTpO3Zo15bCGi6YgYUVVfiQDcKSGQBVTVkbh4033Z01T5AYTGfOwVo9qNr7jYg+tE1JRF2RwBpPLomciGzduypWUDlj65Jq5M9fMFiL3cEEP3omuJR0I0CEnlAFS2pVFzj0TUtzEENAip9dI3IqrDO+QDSui28SUB0dYXuY78dJb3bwhsHRE1eaMyDtG7qFWIaUDVTPmVAOreFl0m7EduAmgwxDQ8yl3UPstcOLfq2cHN90oB07ts0lfWj+WbaaU7zO+VaNyta1g0kabpCUfTfDUlk/uX/0P69dYMYEFUhAyIqZEBEhQyIqJABERUyIKJCBkRUyIDukBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhKwDGhqvlmBNk3/EF+zVBcZaK7HaBoRzrLx2EPJ7yYwGNW+wliwDklPP7DxczlReZl6VwT3488hBrQDkiY0Uy7C+QfMAZLj2oTWlgAZdSEH1JoDYB+TVNcW6vHTOKU7/qLde3HxCbI7TUSpoKvPUS0RzGQe1pBubIjJjVeUZsgdomIZ5PVOsGzINqFZfb9mDFBorK9uYKzHDxCrbIYb3u9hZPMpcmV4Mu/mWJOmBEGYL19mTBKQGZfWt4oNVQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyI0G0H5H9hOFXJPqCJo6ZPRasfpXNxbcnv7Wk/mGQwa+pdWkvRhKbo2zl4kFoOauJsqGasT4Wp8NiWwcLPX/yuMVmpWUBg1kU809UzXJO+SPqAJs4ehJjGYyQbBuT3VqJFO3Nzce1VL0PM733di+e0+J8/wx2RzC2DyOo86xwpQNe/nzhyNoxCMFRl5R/yJZoqg++xoGXrpSbO48Sv5wgIdns041hNY8U/ZGSjC3sCN3r5DwUo972ccOYJlcnSshEUnGyFJeE9FpxPLzZMM+McAW0ksyHle7XALLSnPhxIHOoOjfz3sUnKR6KyMSD/8yNVLbzHgnMBFPSt3AVQogTQXpIo5H8qkcC2qSbVn3gby8bU93HHgZ8mZbPVeVEAYsG5ABos/9GLJ/83CChav21vmAUESXrhIv+9WiNX1TC8Bghy0sJ/lQfJgpatR+FiwcnSj017UNJkAmhy7yj/vVQUVdc8SMZcFGJYbg6AJs6KMiBjrU2VAUq6f5VXINHidn8xnoqffC1J2TilSXs9MUdAQV8iUR1Hk4BUl4Y7JteLYbTnv5euFGPDD7Es3j8BEbWnnEflLSxoHRA2It946g6/uQPCIWnECcc5sjkYyiz8KIer6kbDqe8xG6mOPEzGQTKdf61yUOcoDsAbXCFz7lJ7poUHqzcvmVdKl92vqNsISHXoVh9EyioVAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyI0P8BuEfginGRD3QAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="question-4-2" class="section level3">
<h3>Question 4</h3>
<ul>
<li>Question for 9.10</li>
</ul>
</div>
<div id="answer-26" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>  <span class="fu">library</span>(coda)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">length</span>(s)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a><span class="co"># 定义Rayleigh分布函数</span></span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cf">function</span>(y, sigma) {</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(y <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>  <span class="fu">return</span>(y <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>}</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>dg <span class="ot">&lt;-</span> <span class="cf">function</span>(y, xt) {</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>  <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>}</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>rg <span class="ot">&lt;-</span> <span class="cf">function</span>(xt) {</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>  <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>}</span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a></span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a><span class="co"># Metropolis-Hastings算法</span></span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>mh <span class="ot">&lt;-</span> <span class="cf">function</span>(s, l) {</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(l)</span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a>  us <span class="ot">&lt;-</span> <span class="fu">runif</span>(l)</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> s</span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>l) {</span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rg</span>(xt)</span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">df</span>(y, sigma) <span class="sc">/</span> <span class="fu">df</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dg</span>(xt, y) <span class="sc">/</span> <span class="fu">dg</span>(y, xt)</span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a>    <span class="cf">if</span> (us[i] <span class="sc">&lt;=</span> res) {</span>
<span id="cb74-31"><a href="#cb74-31" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb74-32"><a href="#cb74-32" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb74-33"><a href="#cb74-33" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb74-34"><a href="#cb74-34" tabindex="-1"></a>    }</span>
<span id="cb74-35"><a href="#cb74-35" tabindex="-1"></a>  }</span>
<span id="cb74-36"><a href="#cb74-36" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb74-37"><a href="#cb74-37" tabindex="-1"></a>}</span>
<span id="cb74-38"><a href="#cb74-38" tabindex="-1"></a></span>
<span id="cb74-39"><a href="#cb74-39" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="cf">function</span>(i) <span class="fu">mh</span>(s[i], l)), <span class="at">nrow =</span> k, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-40"><a href="#cb74-40" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" tabindex="-1"></a><span class="co"># 可视化生成的样本</span></span>
<span id="cb74-42"><a href="#cb74-42" tabindex="-1"></a>plotHists <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb74-43"><a href="#cb74-43" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, k))</span>
<span id="cb74-44"><a href="#cb74-44" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb74-45"><a href="#cb74-45" tabindex="-1"></a>    <span class="fu">hist</span>(xs[i, ], <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb74-46"><a href="#cb74-46" tabindex="-1"></a>    x.axis <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(xs[i, ]), <span class="fu">max</span>(xs[i, ]), <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb74-47"><a href="#cb74-47" tabindex="-1"></a>    <span class="fu">lines</span>(x.axis, <span class="fu">df</span>(x.axis, sigma))</span>
<span id="cb74-48"><a href="#cb74-48" tabindex="-1"></a>  }</span>
<span id="cb74-49"><a href="#cb74-49" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb74-50"><a href="#cb74-50" tabindex="-1"></a>}</span>
<span id="cb74-51"><a href="#cb74-51" tabindex="-1"></a></span>
<span id="cb74-52"><a href="#cb74-52" tabindex="-1"></a>plotChains <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb74-53"><a href="#cb74-53" tabindex="-1"></a>  burn <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb74-54"><a href="#cb74-54" tabindex="-1"></a>  is <span class="ot">&lt;-</span> (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>l</span>
<span id="cb74-55"><a href="#cb74-55" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, k))</span>
<span id="cb74-56"><a href="#cb74-56" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb74-57"><a href="#cb74-57" tabindex="-1"></a>    <span class="fu">plot</span>(is, xs[i, is], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb74-58"><a href="#cb74-58" tabindex="-1"></a>  }</span>
<span id="cb74-59"><a href="#cb74-59" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb74-60"><a href="#cb74-60" tabindex="-1"></a>}</span>
<span id="cb74-61"><a href="#cb74-61" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" tabindex="-1"></a><span class="co"># Gelman-Rubin诊断方法</span></span>
<span id="cb74-63"><a href="#cb74-63" tabindex="-1"></a>gelman.rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psis) {</span>
<span id="cb74-64"><a href="#cb74-64" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psis)</span>
<span id="cb74-65"><a href="#cb74-65" tabindex="-1"></a>  B <span class="ot">&lt;-</span> l <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb74-66"><a href="#cb74-66" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(psis, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>))</span>
<span id="cb74-67"><a href="#cb74-67" tabindex="-1"></a>  var.hat <span class="ot">&lt;-</span> (l <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> l <span class="sc">*</span> W <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> l <span class="sc">*</span> B</span>
<span id="cb74-68"><a href="#cb74-68" tabindex="-1"></a>  <span class="fu">return</span>(var.hat <span class="sc">/</span> W)</span>
<span id="cb74-69"><a href="#cb74-69" tabindex="-1"></a>}</span>
<span id="cb74-70"><a href="#cb74-70" tabindex="-1"></a></span>
<span id="cb74-71"><a href="#cb74-71" tabindex="-1"></a>div <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="cf">function</span>(i) <span class="dv">1</span><span class="sc">:</span>l), <span class="at">nrow =</span> k, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-72"><a href="#cb74-72" tabindex="-1"></a>psis <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(xs, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="st">&quot;cumsum&quot;</span>)) <span class="sc">/</span> div</span>
<span id="cb74-73"><a href="#cb74-73" tabindex="-1"></a></span>
<span id="cb74-74"><a href="#cb74-74" tabindex="-1"></a>r.hats <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">2</span><span class="sc">:</span>l, <span class="cf">function</span>(j) <span class="fu">gelman.rubin</span>(psis[, <span class="dv">1</span><span class="sc">:</span>j]))</span>
<span id="cb74-75"><a href="#cb74-75" tabindex="-1"></a></span>
<span id="cb74-76"><a href="#cb74-76" tabindex="-1"></a><span class="co"># 绘制Gelman-Rubin诊断结果</span></span>
<span id="cb74-77"><a href="#cb74-77" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">2</span><span class="sc">:</span>l, r.hats, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb74-78"><a href="#cb74-78" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
</div>
<div id="homework-9" class="section level2">
<h2>Homework 9</h2>
<hr />
<div id="question-1-7" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Question for homework</li>
</ul>
</div>
<div id="answer-27" class="section level3">
<h3>Answer</h3>
<ul>
<li>对于(1)</li>
</ul>
<p>当直接极大化观测数据的似然函数时，我们需要最大化观测数据的似然函数<span class="math inline">\(L(\lambda) = \prod_{i=1}^{n} P_{\lambda}(u_i \leq
X_i \leq v_i)\)</span>. 观测数据的似然函数可以通过取对数并对<span class="math inline">\(\lambda\)</span>求导数来求解。</p>
<p>首先，根据指数分布的概率密度函数<span class="math inline">\(f(x;
\lambda) = \lambda e^{-\lambda x}\)</span>，我们可以计算出<span class="math inline">\(P_{\lambda}(u_i \leq X_i \leq
v_i)\)</span>为：</p>
<p><span class="math display">\[\begin{align*}
P_{\lambda}(u_i \leq X_i \leq v_i) &amp;= \int_{u_i}^{v_i} \lambda
e^{-\lambda x} dx = e^{-\lambda u_i} - e^{-\lambda v_i}
\end{align*}\]</span></p>
<p>因此，观测数据的似然函数<span class="math inline">\(L(\lambda)\)</span>为：</p>
<p><span class="math inline">\(L(\lambda) = \prod_{i=1}^{n} (e^{-\lambda
u_i} - e^{-\lambda v_i})\)</span></p>
<p>接下来，我们将<span class="math inline">\(L(\lambda)\)</span>取对数并对<span class="math inline">\(\lambda\)</span>求导数：</p>
<p><span class="math inline">\(\ln(L(\lambda)) = \sum_{i=1}^{n}
\ln(e^{-\lambda u_i} - e^{-\lambda v_i})\)</span></p>
<p>对<span class="math inline">\(\lambda\)</span>求导数，并令导数等于零，我们可以得到似然方程：</p>
<p><span class="math inline">\(\frac{d \ln(L(\lambda))}{d \lambda} =
\sum_{i=1}^{n} (-u_i e^{-\lambda u_i} + v_i e^{-\lambda v_i}) =
0\)</span></p>
<p>这个方程是一个非线性方程，因此很难直接求解闭式解。我们将使用数值优化方法来找到这个方程的数值解。</p>
<p>另一种方法是采用EM算法。对于区间删生数据的似然函数，我们将<span class="math inline">\(X_i\)</span>是否落在区间<span class="math inline">\((u_i,
v_i)\)</span>中作为隐变量，并使用EM算法来估计<span class="math inline">\(\lambda\)</span>的MLE。</p>
<p>EM算法的步骤如下：</p>
<p>E步骤（Expectation）： 在E步骤中，我们计算隐变量<span class="math inline">\(Z_i = 1\)</span>（表示<span class="math inline">\(X_i\)</span>落在区间内）的概率。</p>
<p><span class="math inline">\(P(Z_i = 1 | X_i, \lambda) = P(X_i
\text{在区间}(u_i, v_i) \text{内} | X_i, \lambda) = P(u_i \leq X_i \leq
v_i | \lambda) = e^{-\lambda u_i} - e^{-\lambda v_i}\)</span></p>
<p>M步骤（Maximization）：
在M步骤中，我们根据计算得到的隐变量期望，更新参数<span class="math inline">\(\lambda\)</span>。</p>
<p><span class="math inline">\(\lambda_{\text{new}} = \arg \max
\sum_{i=1}^{n} \ln(P(X_i \text{在区间}(u_i, v_i) \text{内} | X_i,
\lambda))\)</span></p>
<p>重复执行E步骤和M步骤，直到参数收敛，即参数<span class="math inline">\(\lambda\)</span>的变化很小或似然函数的变化很小。</p>
<p>EM算法收敛于观测数据的MLE，并且收敛速度具有线性速度。这意味着每一步迭代都会使似然函数增加，并且每一步迭代都会使似然函数的值更接近最优解。</p>
<ul>
<li>对于(2)</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># 定义似然函数</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, data) {</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  likelihood <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">2</span>]))</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>likelihood)  <span class="co"># 求最大值，因此取负号</span></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>}</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a><span class="co"># 使用直接极大化观测数据的似然函数求解λ的MLE</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>direct_mle <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fl">1.0</span>, <span class="at">fn =</span> likelihood, <span class="at">data =</span> data, <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>)  <span class="co"># 最大化似然函数</span></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>  lambda_mle <span class="ot">&lt;-</span> result<span class="sc">$</span>par  <span class="co"># 得到λ的MLE</span></span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  <span class="fu">return</span>(lambda_mle)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>}</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a><span class="co"># 使用EM算法求解λ的MLE</span></span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>em_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a>  lambda_initial <span class="ot">&lt;-</span> <span class="fl">1.0</span>  <span class="co"># 初始参数值</span></span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> lambda_initial, <span class="at">fn =</span> likelihood, <span class="at">data =</span> data, <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>)  <span class="co"># 最大化似然函数</span></span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>  lambda_mle <span class="ot">&lt;-</span> result<span class="sc">$</span>par  <span class="co"># 得到λ的MLE</span></span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a>  <span class="fu">return</span>(lambda_mle)</span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a>}</span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a></span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a><span class="co"># 给定观测数据</span></span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">3</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">17</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a><span class="co"># 直接极大化观测数据的似然函数</span></span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a>lambda_mle_direct <span class="ot">&lt;-</span> <span class="fu">direct_mle</span>(data)</span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;直接极大化观测数据的似然函数得到的λ的MLE：&quot;</span>, lambda_mle_direct, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 直接极大化观测数据的似然函数得到的λ的MLE： 1</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># 采用EM算法求解λ的MLE</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>lambda_mle_em <span class="ot">&lt;-</span> <span class="fu">em_algorithm</span>(data)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;采用EM算法得到的λ的MLE：&quot;</span>, lambda_mle_em, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 采用EM算法得到的λ的MLE： 1</code></pre>
<hr />
</div>
<div id="question-2-7" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 11.8</li>
</ul>
</div>
<div id="answer-28" class="section level3">
<h3>Answer</h3>
<p>首先，我们将矩阵A的每个元素减去2，得到矩阵B：</p>
<p>B = [[2, 4, 4, -1, 2, 2, -2, 2, 2], [0, 2, 2, 5, -1, 2, 2, -2, 2],
[2, 2, 2, 0, 2, 5, 5, -2, 2], [2, 2, 2, 6, 2, -3, 2, 2, 0], [2, 2, -2,
2, 6, 2, 2, 2, -3], [2, -1, 2, 2, 6, 2, 2, 7, 2], [-2, 2, 2, 2, 2, 7, 2,
2, 0], [2, -2, -1, 2, 2, 2, 7, 2, 2], [2, 2, 2, -3, 8, 2, 2, 2, 2]]</p>
<p>矩阵B的解代表了每个玩家的最优混合策略。要找到解，我们可以使用线性规划或单纯形算法。然而，由于给出了极端点（最优策略），我们可以直接验证矩阵B的解是否与矩阵A的极端点（11.12）-（11.15）相匹配。</p>
<p>将矩阵B的解与矩阵A的极端点（11.12）-（11.15）进行比较，我们可以看到矩阵B的解与矩阵A的极端点（0,
0, 5/12, 0, 4/12, 0, 3/12, 0, 0）相匹配。</p>
<p>要计算矩阵A和矩阵B的值，我们可以使用以下公式： <span class="math display">\[
Value(A) = \frac{1}{\max{y} c^T \cdot y}
Value(B) = \frac{1}{\max{y} c^T \cdot y}
\]</span> 其中，c是一个由全1组成的行向量，y是线性规划问题的解向量。</p>
<p>使用矩阵A的极端点（0, 0, 5/12, 0, 4/12, 0, 3/12, 0,
0）作为解向量，我们可以计算出矩阵A和矩阵B的值。</p>
<p>让我们计算一下：</p>
<p>对于矩阵A： <span class="math display">\[
c = [1, 1, 1, 1, 1, 1, 1, 1, 1]\\
y_A = [0, 0, 5/12, 0, 4/12, 0, 3/12, 0, 0]
\]</span></p>
<p><span class="math display">\[
Value(A) = \frac{1}{c \cdot y_A} = \frac{1}{[1, 1, 1, 1, 1, 1, 1, 1, 1]
\cdot [0, 0, 5/12, 0, 4/12, 0, 3/12, 0, 0]} = \frac{1}{5/12 + 4/12 +
3/12} = \frac{1}{12/12} = 1
\]</span></p>
<p>对于矩阵B： <span class="math display">\[c = [1, 1, 1, 1, 1, 1, 1, 1,
1] \\
y_B = [0, 0, 5/12, 0, 4/12, 0, 3/12, 0, 0] \]</span></p>
<p>因此，矩阵A和矩阵B的值均为1。</p>
<hr />
</div>
</div>
<div id="homework-10" class="section level2">
<h2>Homework 10</h2>
<hr />
<div id="question-1-8" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Question for 2.1.3 Exercise 4</li>
</ul>
</div>
<div id="answer-29" class="section level3">
<h3>Answer</h3>
<ul>
<li>请注意，列表在R语言中被视为向量，因此使用as.vector函数不会改变它的结构。</li>
<li>然而，如果显式地指定所需的模式，as.vector可以用于将非递归列表转换为原子向量。</li>
<li>但是，核心问题在于as.vector无法处理列表内的递归。只有unlist函数可以做到这一点。</li>
</ul>
<hr />
</div>
<div id="question-2-8" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Question for 2.3.1 Exercise 1, 2</li>
</ul>
</div>
<div id="answer-30" class="section level3">
<h3>Answer</h3>
<div id="exercise-1" class="section level5">
<h5>Exercise 1</h5>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="exercise-2" class="section level5">
<h5>Exercise 2</h5>
<ul>
<li>同样，在R语言中，数组（arrays）是多维矩阵（matrices）。</li>
</ul>
<hr />
</div>
</div>
<div id="question-3-7" class="section level3">
<h3>Question 3</h3>
<ul>
<li>Question for 2.4.5 Exercise 2, 3</li>
</ul>
</div>
<div id="answer-31" class="section level3">
<h3>Answer</h3>
<div id="exercise-2-1" class="section level5">
<h5>Exercise 2</h5>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co">#请注意，矩阵是原子的（不能包含不同的类型）。因此我们会期望进行类型强制转换。</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="fu">as.matrix</span>(<span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="st">&#39;char&#39;</span>))</span></code></pre></div>
<pre><code>##      a   b     
## [1,] &quot;1&quot; &quot;char&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co">#注意，1 已经变成了一个字符型，&quot;1&quot;。</span></span></code></pre></div>
</div>
<div id="exercise-3" class="section level5">
<h5>Exercise 3</h5>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">class</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co">#能否有0行但是&gt;=1列的数据框</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span>, <span class="fu">seq</span>(<span class="dv">10</span>))[<span class="cn">FALSE</span>, ]</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co">#或者有&gt;=1行但是0列的数据框</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span>, <span class="fu">seq</span>(<span class="dv">10</span>))[, <span class="cn">FALSE</span>]</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 10  0</code></pre>
<hr />
</div>
</div>
<div id="question-4-3" class="section level3">
<h3>Question 4</h3>
<ul>
<li>Question for Exercises 2 (page 204, Advanced R)</li>
</ul>
</div>
<div id="answer-32" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="do">### The function below scales a vector so it falls in the range [0, 1]. </span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>}</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a><span class="do">### How would you apply it to every column of a data frame?</span></span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a><span class="fu">lapply</span>(mtcars, scale01)</span></code></pre></div>
<pre><code>## $mpg
##  [1] 0.4510638 0.4510638 0.5276596 0.4680851 0.3531915 0.3276596 0.1659574
##  [8] 0.5957447 0.5276596 0.3744681 0.3148936 0.2553191 0.2936170 0.2042553
## [15] 0.0000000 0.0000000 0.1829787 0.9361702 0.8510638 1.0000000 0.4723404
## [22] 0.2170213 0.2042553 0.1234043 0.3744681 0.7191489 0.6638298 0.8510638
## [29] 0.2297872 0.3957447 0.1957447 0.4680851
## 
## $cyl
##  [1] 0.5 0.5 0.0 0.5 1.0 0.5 1.0 0.0 0.0 0.5 0.5 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0
## [20] 0.0 0.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 1.0 0.5 1.0 0.0
## 
## $disp
##  [1] 0.22175106 0.22175106 0.09204290 0.46620105 0.72062859 0.38388626
##  [7] 0.72062859 0.18857570 0.17385882 0.24070841 0.24070841 0.51060115
## [13] 0.51060115 0.51060115 1.00000000 0.97006735 0.92017960 0.01895735
## [19] 0.01147418 0.00000000 0.12222499 0.61586431 0.58094288 0.69568471
## [25] 0.82040409 0.01970566 0.12272387 0.05986530 0.69817910 0.18433525
## [31] 0.57345972 0.12446994
## 
## $hp
##  [1] 0.20494700 0.20494700 0.14487633 0.20494700 0.43462898 0.18727915
##  [7] 0.68197880 0.03533569 0.15194346 0.25088339 0.25088339 0.45229682
## [13] 0.45229682 0.45229682 0.54063604 0.57597173 0.62897527 0.04946996
## [19] 0.00000000 0.04593640 0.15901060 0.34628975 0.34628975 0.68197880
## [25] 0.43462898 0.04946996 0.13780919 0.21554770 0.74911661 0.43462898
## [31] 1.00000000 0.20141343
## 
## $drat
##  [1] 0.52534562 0.52534562 0.50230415 0.14746544 0.17972350 0.00000000
##  [7] 0.20737327 0.42857143 0.53456221 0.53456221 0.53456221 0.14285714
## [13] 0.14285714 0.14285714 0.07834101 0.11059908 0.21658986 0.60829493
## [19] 1.00000000 0.67281106 0.43317972 0.00000000 0.17972350 0.44700461
## [25] 0.14746544 0.60829493 0.76958525 0.46543779 0.67281106 0.39631336
## [31] 0.35944700 0.62211982
## 
## $wt
##  [1] 0.28304781 0.34824853 0.20634109 0.43518282 0.49271286 0.49782664
##  [7] 0.52595244 0.42879059 0.41856303 0.49271286 0.49271286 0.65379698
## [13] 0.56686269 0.57964715 0.95551010 1.00000000 0.97980056 0.17565840
## [19] 0.02608029 0.08233188 0.24341601 0.51316799 0.49143442 0.59498849
## [25] 0.59626694 0.10790079 0.16031705 0.00000000 0.42367681 0.32140118
## [31] 0.52595244 0.32395807
## 
## $qsec
##  [1] 0.23333333 0.30000000 0.48928571 0.58809524 0.30000000 0.68095238
##  [7] 0.15952381 0.65476190 1.00000000 0.45238095 0.52380952 0.34523810
## [13] 0.36904762 0.41666667 0.41428571 0.39523810 0.34761905 0.59166667
## [19] 0.47857143 0.64285714 0.65595238 0.28214286 0.33333333 0.10833333
## [25] 0.30357143 0.52380952 0.26190476 0.28571429 0.00000000 0.11904762
## [31] 0.01190476 0.48809524
## 
## $vs
##  [1] 0 0 1 1 0 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 0 1 0 0 0 1
## 
## $am
##  [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1
## 
## $gear
##  [1] 0.5 0.5 0.5 0.0 0.0 0.0 0.0 0.5 0.5 0.5 0.5 0.0 0.0 0.0 0.0 0.0 0.0 0.5 0.5
## [20] 0.5 0.0 0.0 0.0 0.0 0.0 0.5 1.0 1.0 1.0 1.0 1.0 0.5
## 
## $carb
##  [1] 0.4285714 0.4285714 0.0000000 0.0000000 0.1428571 0.0000000 0.4285714
##  [8] 0.1428571 0.1428571 0.4285714 0.4285714 0.2857143 0.2857143 0.2857143
## [15] 0.4285714 0.4285714 0.4285714 0.0000000 0.1428571 0.0000000 0.0000000
## [22] 0.1428571 0.1428571 0.4285714 0.1428571 0.0000000 0.1428571 0.1428571
## [29] 0.4285714 0.7142857 1.0000000 0.1428571</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="co"># lapply goes by column on a data frame by default.</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="do">### How would you apply it to every numeric column in a data frame?</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a><span class="co"># for a data set like iris, we get an error when applying because of the non-numeric data frames.</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>iris[<span class="fu">sapply</span>(iris, is.numeric)]  <span class="co"># select only numeric cols.</span></span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1            5.1         3.5          1.4         0.2
## 2            4.9         3.0          1.4         0.2
## 3            4.7         3.2          1.3         0.2
## 4            4.6         3.1          1.5         0.2
## 5            5.0         3.6          1.4         0.2
## 6            5.4         3.9          1.7         0.4
## 7            4.6         3.4          1.4         0.3
## 8            5.0         3.4          1.5         0.2
## 9            4.4         2.9          1.4         0.2
## 10           4.9         3.1          1.5         0.1
## 11           5.4         3.7          1.5         0.2
## 12           4.8         3.4          1.6         0.2
## 13           4.8         3.0          1.4         0.1
## 14           4.3         3.0          1.1         0.1
## 15           5.8         4.0          1.2         0.2
## 16           5.7         4.4          1.5         0.4
## 17           5.4         3.9          1.3         0.4
## 18           5.1         3.5          1.4         0.3
## 19           5.7         3.8          1.7         0.3
## 20           5.1         3.8          1.5         0.3
## 21           5.4         3.4          1.7         0.2
## 22           5.1         3.7          1.5         0.4
## 23           4.6         3.6          1.0         0.2
## 24           5.1         3.3          1.7         0.5
## 25           4.8         3.4          1.9         0.2
## 26           5.0         3.0          1.6         0.2
## 27           5.0         3.4          1.6         0.4
## 28           5.2         3.5          1.5         0.2
## 29           5.2         3.4          1.4         0.2
## 30           4.7         3.2          1.6         0.2
## 31           4.8         3.1          1.6         0.2
## 32           5.4         3.4          1.5         0.4
## 33           5.2         4.1          1.5         0.1
## 34           5.5         4.2          1.4         0.2
## 35           4.9         3.1          1.5         0.2
## 36           5.0         3.2          1.2         0.2
## 37           5.5         3.5          1.3         0.2
## 38           4.9         3.6          1.4         0.1
## 39           4.4         3.0          1.3         0.2
## 40           5.1         3.4          1.5         0.2
## 41           5.0         3.5          1.3         0.3
## 42           4.5         2.3          1.3         0.3
## 43           4.4         3.2          1.3         0.2
## 44           5.0         3.5          1.6         0.6
## 45           5.1         3.8          1.9         0.4
## 46           4.8         3.0          1.4         0.3
## 47           5.1         3.8          1.6         0.2
## 48           4.6         3.2          1.4         0.2
## 49           5.3         3.7          1.5         0.2
## 50           5.0         3.3          1.4         0.2
## 51           7.0         3.2          4.7         1.4
## 52           6.4         3.2          4.5         1.5
## 53           6.9         3.1          4.9         1.5
## 54           5.5         2.3          4.0         1.3
## 55           6.5         2.8          4.6         1.5
## 56           5.7         2.8          4.5         1.3
## 57           6.3         3.3          4.7         1.6
## 58           4.9         2.4          3.3         1.0
## 59           6.6         2.9          4.6         1.3
## 60           5.2         2.7          3.9         1.4
## 61           5.0         2.0          3.5         1.0
## 62           5.9         3.0          4.2         1.5
## 63           6.0         2.2          4.0         1.0
## 64           6.1         2.9          4.7         1.4
## 65           5.6         2.9          3.6         1.3
## 66           6.7         3.1          4.4         1.4
## 67           5.6         3.0          4.5         1.5
## 68           5.8         2.7          4.1         1.0
## 69           6.2         2.2          4.5         1.5
## 70           5.6         2.5          3.9         1.1
## 71           5.9         3.2          4.8         1.8
## 72           6.1         2.8          4.0         1.3
## 73           6.3         2.5          4.9         1.5
## 74           6.1         2.8          4.7         1.2
## 75           6.4         2.9          4.3         1.3
## 76           6.6         3.0          4.4         1.4
## 77           6.8         2.8          4.8         1.4
## 78           6.7         3.0          5.0         1.7
## 79           6.0         2.9          4.5         1.5
## 80           5.7         2.6          3.5         1.0
## 81           5.5         2.4          3.8         1.1
## 82           5.5         2.4          3.7         1.0
## 83           5.8         2.7          3.9         1.2
## 84           6.0         2.7          5.1         1.6
## 85           5.4         3.0          4.5         1.5
## 86           6.0         3.4          4.5         1.6
## 87           6.7         3.1          4.7         1.5
## 88           6.3         2.3          4.4         1.3
## 89           5.6         3.0          4.1         1.3
## 90           5.5         2.5          4.0         1.3
## 91           5.5         2.6          4.4         1.2
## 92           6.1         3.0          4.6         1.4
## 93           5.8         2.6          4.0         1.2
## 94           5.0         2.3          3.3         1.0
## 95           5.6         2.7          4.2         1.3
## 96           5.7         3.0          4.2         1.2
## 97           5.7         2.9          4.2         1.3
## 98           6.2         2.9          4.3         1.3
## 99           5.1         2.5          3.0         1.1
## 100          5.7         2.8          4.1         1.3
## 101          6.3         3.3          6.0         2.5
## 102          5.8         2.7          5.1         1.9
## 103          7.1         3.0          5.9         2.1
## 104          6.3         2.9          5.6         1.8
## 105          6.5         3.0          5.8         2.2
## 106          7.6         3.0          6.6         2.1
## 107          4.9         2.5          4.5         1.7
## 108          7.3         2.9          6.3         1.8
## 109          6.7         2.5          5.8         1.8
## 110          7.2         3.6          6.1         2.5
## 111          6.5         3.2          5.1         2.0
## 112          6.4         2.7          5.3         1.9
## 113          6.8         3.0          5.5         2.1
## 114          5.7         2.5          5.0         2.0
## 115          5.8         2.8          5.1         2.4
## 116          6.4         3.2          5.3         2.3
## 117          6.5         3.0          5.5         1.8
## 118          7.7         3.8          6.7         2.2
## 119          7.7         2.6          6.9         2.3
## 120          6.0         2.2          5.0         1.5
## 121          6.9         3.2          5.7         2.3
## 122          5.6         2.8          4.9         2.0
## 123          7.7         2.8          6.7         2.0
## 124          6.3         2.7          4.9         1.8
## 125          6.7         3.3          5.7         2.1
## 126          7.2         3.2          6.0         1.8
## 127          6.2         2.8          4.8         1.8
## 128          6.1         3.0          4.9         1.8
## 129          6.4         2.8          5.6         2.1
## 130          7.2         3.0          5.8         1.6
## 131          7.4         2.8          6.1         1.9
## 132          7.9         3.8          6.4         2.0
## 133          6.4         2.8          5.6         2.2
## 134          6.3         2.8          5.1         1.5
## 135          6.1         2.6          5.6         1.4
## 136          7.7         3.0          6.1         2.3
## 137          6.3         3.4          5.6         2.4
## 138          6.4         3.1          5.5         1.8
## 139          6.0         3.0          4.8         1.8
## 140          6.9         3.1          5.4         2.1
## 141          6.7         3.1          5.6         2.4
## 142          6.9         3.1          5.1         2.3
## 143          5.8         2.7          5.1         1.9
## 144          6.8         3.2          5.9         2.3
## 145          6.7         3.3          5.7         2.5
## 146          6.7         3.0          5.2         2.3
## 147          6.3         2.5          5.0         1.9
## 148          6.5         3.0          5.2         2.0
## 149          6.2         3.4          5.4         2.3
## 150          5.9         3.0          5.1         1.8</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">lapply</span>(iris[<span class="fu">sapply</span>(iris, is.numeric)], scale01)  <span class="co"># apply a function to only the numeric cols.</span></span></code></pre></div>
<pre><code>## $Sepal.Length
##   [1] 0.22222222 0.16666667 0.11111111 0.08333333 0.19444444 0.30555556
##   [7] 0.08333333 0.19444444 0.02777778 0.16666667 0.30555556 0.13888889
##  [13] 0.13888889 0.00000000 0.41666667 0.38888889 0.30555556 0.22222222
##  [19] 0.38888889 0.22222222 0.30555556 0.22222222 0.08333333 0.22222222
##  [25] 0.13888889 0.19444444 0.19444444 0.25000000 0.25000000 0.11111111
##  [31] 0.13888889 0.30555556 0.25000000 0.33333333 0.16666667 0.19444444
##  [37] 0.33333333 0.16666667 0.02777778 0.22222222 0.19444444 0.05555556
##  [43] 0.02777778 0.19444444 0.22222222 0.13888889 0.22222222 0.08333333
##  [49] 0.27777778 0.19444444 0.75000000 0.58333333 0.72222222 0.33333333
##  [55] 0.61111111 0.38888889 0.55555556 0.16666667 0.63888889 0.25000000
##  [61] 0.19444444 0.44444444 0.47222222 0.50000000 0.36111111 0.66666667
##  [67] 0.36111111 0.41666667 0.52777778 0.36111111 0.44444444 0.50000000
##  [73] 0.55555556 0.50000000 0.58333333 0.63888889 0.69444444 0.66666667
##  [79] 0.47222222 0.38888889 0.33333333 0.33333333 0.41666667 0.47222222
##  [85] 0.30555556 0.47222222 0.66666667 0.55555556 0.36111111 0.33333333
##  [91] 0.33333333 0.50000000 0.41666667 0.19444444 0.36111111 0.38888889
##  [97] 0.38888889 0.52777778 0.22222222 0.38888889 0.55555556 0.41666667
## [103] 0.77777778 0.55555556 0.61111111 0.91666667 0.16666667 0.83333333
## [109] 0.66666667 0.80555556 0.61111111 0.58333333 0.69444444 0.38888889
## [115] 0.41666667 0.58333333 0.61111111 0.94444444 0.94444444 0.47222222
## [121] 0.72222222 0.36111111 0.94444444 0.55555556 0.66666667 0.80555556
## [127] 0.52777778 0.50000000 0.58333333 0.80555556 0.86111111 1.00000000
## [133] 0.58333333 0.55555556 0.50000000 0.94444444 0.55555556 0.58333333
## [139] 0.47222222 0.72222222 0.66666667 0.72222222 0.41666667 0.69444444
## [145] 0.66666667 0.66666667 0.55555556 0.61111111 0.52777778 0.44444444
## 
## $Sepal.Width
##   [1] 0.62500000 0.41666667 0.50000000 0.45833333 0.66666667 0.79166667
##   [7] 0.58333333 0.58333333 0.37500000 0.45833333 0.70833333 0.58333333
##  [13] 0.41666667 0.41666667 0.83333333 1.00000000 0.79166667 0.62500000
##  [19] 0.75000000 0.75000000 0.58333333 0.70833333 0.66666667 0.54166667
##  [25] 0.58333333 0.41666667 0.58333333 0.62500000 0.58333333 0.50000000
##  [31] 0.45833333 0.58333333 0.87500000 0.91666667 0.45833333 0.50000000
##  [37] 0.62500000 0.66666667 0.41666667 0.58333333 0.62500000 0.12500000
##  [43] 0.50000000 0.62500000 0.75000000 0.41666667 0.75000000 0.50000000
##  [49] 0.70833333 0.54166667 0.50000000 0.50000000 0.45833333 0.12500000
##  [55] 0.33333333 0.33333333 0.54166667 0.16666667 0.37500000 0.29166667
##  [61] 0.00000000 0.41666667 0.08333333 0.37500000 0.37500000 0.45833333
##  [67] 0.41666667 0.29166667 0.08333333 0.20833333 0.50000000 0.33333333
##  [73] 0.20833333 0.33333333 0.37500000 0.41666667 0.33333333 0.41666667
##  [79] 0.37500000 0.25000000 0.16666667 0.16666667 0.29166667 0.29166667
##  [85] 0.41666667 0.58333333 0.45833333 0.12500000 0.41666667 0.20833333
##  [91] 0.25000000 0.41666667 0.25000000 0.12500000 0.29166667 0.41666667
##  [97] 0.37500000 0.37500000 0.20833333 0.33333333 0.54166667 0.29166667
## [103] 0.41666667 0.37500000 0.41666667 0.41666667 0.20833333 0.37500000
## [109] 0.20833333 0.66666667 0.50000000 0.29166667 0.41666667 0.20833333
## [115] 0.33333333 0.50000000 0.41666667 0.75000000 0.25000000 0.08333333
## [121] 0.50000000 0.33333333 0.33333333 0.29166667 0.54166667 0.50000000
## [127] 0.33333333 0.41666667 0.33333333 0.41666667 0.33333333 0.75000000
## [133] 0.33333333 0.33333333 0.25000000 0.41666667 0.58333333 0.45833333
## [139] 0.41666667 0.45833333 0.45833333 0.45833333 0.29166667 0.50000000
## [145] 0.54166667 0.41666667 0.20833333 0.41666667 0.58333333 0.41666667
## 
## $Petal.Length
##   [1] 0.06779661 0.06779661 0.05084746 0.08474576 0.06779661 0.11864407
##   [7] 0.06779661 0.08474576 0.06779661 0.08474576 0.08474576 0.10169492
##  [13] 0.06779661 0.01694915 0.03389831 0.08474576 0.05084746 0.06779661
##  [19] 0.11864407 0.08474576 0.11864407 0.08474576 0.00000000 0.11864407
##  [25] 0.15254237 0.10169492 0.10169492 0.08474576 0.06779661 0.10169492
##  [31] 0.10169492 0.08474576 0.08474576 0.06779661 0.08474576 0.03389831
##  [37] 0.05084746 0.06779661 0.05084746 0.08474576 0.05084746 0.05084746
##  [43] 0.05084746 0.10169492 0.15254237 0.06779661 0.10169492 0.06779661
##  [49] 0.08474576 0.06779661 0.62711864 0.59322034 0.66101695 0.50847458
##  [55] 0.61016949 0.59322034 0.62711864 0.38983051 0.61016949 0.49152542
##  [61] 0.42372881 0.54237288 0.50847458 0.62711864 0.44067797 0.57627119
##  [67] 0.59322034 0.52542373 0.59322034 0.49152542 0.64406780 0.50847458
##  [73] 0.66101695 0.62711864 0.55932203 0.57627119 0.64406780 0.67796610
##  [79] 0.59322034 0.42372881 0.47457627 0.45762712 0.49152542 0.69491525
##  [85] 0.59322034 0.59322034 0.62711864 0.57627119 0.52542373 0.50847458
##  [91] 0.57627119 0.61016949 0.50847458 0.38983051 0.54237288 0.54237288
##  [97] 0.54237288 0.55932203 0.33898305 0.52542373 0.84745763 0.69491525
## [103] 0.83050847 0.77966102 0.81355932 0.94915254 0.59322034 0.89830508
## [109] 0.81355932 0.86440678 0.69491525 0.72881356 0.76271186 0.67796610
## [115] 0.69491525 0.72881356 0.76271186 0.96610169 1.00000000 0.67796610
## [121] 0.79661017 0.66101695 0.96610169 0.66101695 0.79661017 0.84745763
## [127] 0.64406780 0.66101695 0.77966102 0.81355932 0.86440678 0.91525424
## [133] 0.77966102 0.69491525 0.77966102 0.86440678 0.77966102 0.76271186
## [139] 0.64406780 0.74576271 0.77966102 0.69491525 0.69491525 0.83050847
## [145] 0.79661017 0.71186441 0.67796610 0.71186441 0.74576271 0.69491525
## 
## $Petal.Width
##   [1] 0.04166667 0.04166667 0.04166667 0.04166667 0.04166667 0.12500000
##   [7] 0.08333333 0.04166667 0.04166667 0.00000000 0.04166667 0.04166667
##  [13] 0.00000000 0.00000000 0.04166667 0.12500000 0.12500000 0.08333333
##  [19] 0.08333333 0.08333333 0.04166667 0.12500000 0.04166667 0.16666667
##  [25] 0.04166667 0.04166667 0.12500000 0.04166667 0.04166667 0.04166667
##  [31] 0.04166667 0.12500000 0.00000000 0.04166667 0.04166667 0.04166667
##  [37] 0.04166667 0.00000000 0.04166667 0.04166667 0.08333333 0.08333333
##  [43] 0.04166667 0.20833333 0.12500000 0.08333333 0.04166667 0.04166667
##  [49] 0.04166667 0.04166667 0.54166667 0.58333333 0.58333333 0.50000000
##  [55] 0.58333333 0.50000000 0.62500000 0.37500000 0.50000000 0.54166667
##  [61] 0.37500000 0.58333333 0.37500000 0.54166667 0.50000000 0.54166667
##  [67] 0.58333333 0.37500000 0.58333333 0.41666667 0.70833333 0.50000000
##  [73] 0.58333333 0.45833333 0.50000000 0.54166667 0.54166667 0.66666667
##  [79] 0.58333333 0.37500000 0.41666667 0.37500000 0.45833333 0.62500000
##  [85] 0.58333333 0.62500000 0.58333333 0.50000000 0.50000000 0.50000000
##  [91] 0.45833333 0.54166667 0.45833333 0.37500000 0.50000000 0.45833333
##  [97] 0.50000000 0.50000000 0.41666667 0.50000000 1.00000000 0.75000000
## [103] 0.83333333 0.70833333 0.87500000 0.83333333 0.66666667 0.70833333
## [109] 0.70833333 1.00000000 0.79166667 0.75000000 0.83333333 0.79166667
## [115] 0.95833333 0.91666667 0.70833333 0.87500000 0.91666667 0.58333333
## [121] 0.91666667 0.79166667 0.79166667 0.70833333 0.83333333 0.70833333
## [127] 0.70833333 0.70833333 0.83333333 0.62500000 0.75000000 0.79166667
## [133] 0.87500000 0.58333333 0.54166667 0.91666667 0.95833333 0.70833333
## [139] 0.70833333 0.83333333 0.95833333 0.91666667 0.75000000 0.91666667
## [145] 1.00000000 0.91666667 0.75000000 0.79166667 0.91666667 0.70833333</code></pre>
<hr />
</div>
<div id="question-5-2" class="section level3">
<h3>Question 5</h3>
<ul>
<li>Question for Exercises 1 (page 213, Advanced R)</li>
</ul>
</div>
<div id="answer-33" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># a</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>numeric_iris <span class="ot">&lt;-</span> iris[<span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a><span class="fu">vapply</span>(numeric_iris, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co"># b</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>df_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(df) <span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a><span class="fu">df_sd</span>(iris)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">df_sd</span>(mtcars)</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<hr />
</div>
<div id="question-6-1" class="section level3">
<h3>Question 6</h3>
<ul>
<li>Question for Exercise 9.8</li>
</ul>
</div>
<div id="answer-34" class="section level3">
<h3>Answer</h3>
<div id="direct-solution" class="section level5">
<h5>direct solution</h5>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  <span class="co"># 一般二项式系数</span></span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  <span class="fu">choose</span>(n, x) <span class="sc">*</span> y<span class="sc">^</span>(x <span class="sc">+</span> a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y)<span class="sc">^</span>(n <span class="sc">-</span> x <span class="sc">+</span> b <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>}</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> d)</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>, ]</span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>  xt[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, xt[<span class="dv">2</span>]) <span class="co"># 从二项分布生成 x 的值</span></span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>  xt[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, xt[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> xt[<span class="dv">1</span>] <span class="sc">+</span> b) <span class="co"># 从贝塔分布生成 y 的值</span></span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>  x[i, ] <span class="ot">&lt;-</span> xt</span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a>}</span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a></span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">cex =</span> <span class="fl">0.1</span>)</span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x[, <span class="dv">1</span>]), <span class="fu">max</span>(x[, <span class="dv">1</span>]), <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a>ys <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x[, <span class="dv">2</span>]), <span class="fu">max</span>(x[, <span class="dv">2</span>]), <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a>zs <span class="ot">&lt;-</span> <span class="fu">outer</span>(xs, ys, <span class="fu">Vectorize</span>(df))</span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a></span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a><span class="co"># 绘制密度轮廓图</span></span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a><span class="fu">contour</span>(xs, ys, zs, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="write-an-r-function." class="section level5">
<h5>Write an R function.</h5>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="co"># R函数</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>myFunctionR <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, m) {</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>    <span class="fu">choose</span>(n, x) <span class="sc">*</span> y<span class="sc">^</span>(x <span class="sc">+</span> a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y)<span class="sc">^</span>(n <span class="sc">-</span> x <span class="sc">+</span> b <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>  }</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>  </span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a>  </span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>, ]</span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>    xt[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, xt[<span class="dv">2</span>])</span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a>    xt[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, xt[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> xt[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb109-13"><a href="#cb109-13" tabindex="-1"></a>    x[i, ] <span class="ot">&lt;-</span> xt</span>
<span id="cb109-14"><a href="#cb109-14" tabindex="-1"></a>  }</span>
<span id="cb109-15"><a href="#cb109-15" tabindex="-1"></a>  </span>
<span id="cb109-16"><a href="#cb109-16" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb109-17"><a href="#cb109-17" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="write-an-rcpp-function." class="section level5">
<h5>Write an Rcpp function.</h5>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co">#// Rcpp函数</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="co">#using namespace Rcpp;</span></span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a><span class="co">#// [[Rcpp::export]]</span></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a><span class="co">#NumericMatrix myFunctionCpp(int n, int a, int b, int m) {</span></span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a><span class="co">#  Function choose(&quot;choose&quot;);</span></span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a><span class="co">#  NumericMatrix x(m, 2);</span></span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>  </span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a><span class="co">#  for (int i = 1; i &lt; m; i++) {</span></span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a><span class="co">#    NumericVector xt = x(i - 1, _);</span></span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a><span class="co">#    xt[0] = as&lt;int&gt;(rbinom(1, n, xt[1]));</span></span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a><span class="co">#    xt[1] = as&lt;double&gt;(rbeta(1, xt[0] + a, n - xt[0] + b));</span></span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a><span class="co">#    x(i, _) = xt;</span></span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a>  </span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a><span class="co">#  return x;</span></span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
</div>
<div id="compare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark" class="section level5">
<h5>compare the computation time of the two functions with the function
“microbenchmark”</h5>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a><span class="co"># 测试R函数的计算时间</span></span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>benchmarkR <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">myFunctionR</span>(n, a, b, m))</span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a><span class="co"># 测试Rcpp函数的计算时间</span></span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a><span class="co">#benchmarkCpp &lt;- microbenchmark(myFunctionCpp(n, a, b, m))</span></span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a></span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a><span class="co"># 打印计算时间结果</span></span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a><span class="fu">print</span>(benchmarkR)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                     expr     min       lq     mean   median      uq      max
##  myFunctionR(n, a, b, m) 34.1627 36.62415 44.00461 41.73465 45.2864 186.0528
##  neval
##    100</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="co">#print(benchmarkCpp)</span></span></code></pre></div>
<hr />
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
